# dubbogo 测试 #
---
   * written by Alex Stocks 2016/08/08 - 2016-08-11
          
## 1 协议 ##
---

目前使用的协议为http based jsonrpc 2.0.   

## 2 场景测试 ##
---

### 2.1 有cmg & zk，无status，然后启动一个status ###
---

本测试的目的是观察先启动consumer后启动provider的时候，dubbogo是否能在provider启动后及时观察到provider。 

#### 2.1.1 观察 cmg console.log ####
---
  
在这个场景下从08/09/16 14:20:24开始测试，持续到[08/09/16 15:08:46]，共48m，期间cmg运行log如下：

    [08/09/16 15:08:32] [WARN] get a zookeeper event{zk.Event{Type:-1, State:101, Path:"", Err:error(nil), Server:"116.211.15.192:2201"}}, state{101}:zookeeper has session
	[08/09/16 15:08:35] [INFO] zk{path:[116.211.15.192:2201], name:watcher zk registry} connection goroutine game over.
	2016/08/09 15:08:35 Recv loop terminated: err=EOF
	2016/08/09 15:08:35 Send loop terminated: err=<nil>
	[08/09/16 15:08:35] [WARN] zk client{name:watcher zk registry, zk addr:[116.211.15.192:2201]} exit now.
	[08/09/16 15:08:35] [WARN] cacheSelector.watch() = error{path{/dubbo/im.youni.token.api.AccessKeyService/providers} has none children}
	[08/09/16 15:08:36] [INFO] watch dubbo provider path{/dubbo/im.youni.token.api.AccessKeyService/providers} and wait to get all provider zk nodes
	[08/09/16 15:08:36] [WARN] get a zookeeper event{zk.Event{Type:-1, State:1, Path:"", Err:error(nil), Server:"116.211.15.192:2201"}}, state{1}:zookeeper connecting
	2016/08/09 15:08:36 Connected to 116.211.15.192:2201
	2016/08/09 15:08:36 Authenticated: id=96384857520341461, timeout=40000
	[08/09/16 15:08:36] [EROR] fail to get children of zk path{/dubbo/im.youni.token.api.AccessKeyService/providers}
	[08/09/16 15:08:36] [INFO] watch dubbo path{/dubbo/im.youni.token.api.AccessKeyService/providers}
	[08/09/16 15:08:36] [INFO] watch dubbo provider path{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers} and wait to get all provider zk nodes
	[08/09/16 15:08:36] [EROR] fail to get children of zk path{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers}
	[08/09/16 15:08:36] [INFO] watch dubbo path{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers}
	[08/09/16 15:08:36] [EROR] watchDir(path{/dubbo/im.youni.token.api.AccessKeyService/providers}) = error{path{/dubbo/im.youni.token.api.AccessKeyService/providers} has none children}
	[08/09/16 15:08:36] [WARN] watchDir(zkPath{/dubbo/im.youni.token.api.AccessKeyService/providers}) exit now
	[08/09/16 15:08:36] [EROR] watchDir(path{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers}) = error{path{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers} has none children}
	[08/09/16 15:08:36] [WARN] watchDir(zkPath{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers}) exit now
	[08/09/16 15:08:39] [INFO] zk{path:[116.211.15.192:2201], name:watcher zk registry} connection goroutine game over.
	2016/08/09 15:08:39 Recv loop terminated: err=EOF
	2016/08/09 15:08:39 Send loop terminated: err=<nil>
	[08/09/16 15:08:39] [WARN] zk client{name:watcher zk registry, zk addr:[116.211.15.192:2201]} exit now.
	[08/09/16 15:08:39] [WARN] cacheSelector.watch() = error{path{/dubbo/im.youni.token.api.AccessKeyService/providers} has none children}
	2016/08/09 15:08:40 Connected to 116.211.15.192:2201
	[08/09/16 15:08:40] [WARN] get a zookeeper event{zk.Event{Type:-1, State:1, Path:"", Err:error(nil), Server:"116.211.15.192:2201"}}, state{1}:zookeeper connecting
	[08/09/16 15:08:40] [INFO] watch dubbo provider path{/dubbo/im.youni.token.api.AccessKeyService/providers} and wait to get all provider zk nodes
	2016/08/09 15:08:40 Authenticated: id=96384857520341462, timeout=40000
	[08/09/16 15:08:40] [EROR] fail to get children of zk path{/dubbo/im.youni.token.api.AccessKeyService/providers}
	[08/09/16 15:08:40] [INFO] watch dubbo path{/dubbo/im.youni.token.api.AccessKeyService/providers}
	[08/09/16 15:08:40] [INFO] watch dubbo provider path{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers} and wait to get all provider zk nodes
	[08/09/16 15:08:40] [EROR] fail to get children of zk path{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers}
	[08/09/16 15:08:40] [INFO] watch dubbo path{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers}
	[08/09/16 15:08:40] [EROR] watchDir(path{/dubbo/im.youni.token.api.AccessKeyService/providers}) = error{path{/dubbo/im.youni.token.api.AccessKeyService/providers} has none children}
	[08/09/16 15:08:40] [WARN] watchDir(zkPath{/dubbo/im.youni.token.api.AccessKeyService/providers}) exit now
	[08/09/16 15:08:40] [EROR] watchDir(path{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers}) = error{path{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers} has none children}
	[08/09/16 15:08:40] [WARN] watchDir(zkPath{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers}) exit now
	[08/09/16 15:08:43] [WARN] get a zookeeper event{zk.Event{Type:-1, State:100, Path:"", Err:error(nil), Server:"116.211.15.192:2201"}}, state{100}:zookeeper conneced
	[08/09/16 15:08:46] [WARN] get a zookeeper event{zk.Event{Type:-1, State:101, Path:"", Err:error(nil), Server:"116.211.15.192:2201"}}, state{101}:zookeeper has session   

    
> 从log内容来看，dubbogo-cmg一直持续每隔3s就在尝试获取相关service的providers，行为符合dubbogo的设计。
 
> 2016/08/11补充：目前采用递增方法让间隔时间从3s开始依次增长，最大值为30s，效果如下:   
		
	[2016/08/11 17:22:16 CST] [EROR] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:187] watchDir(path{/dubbo/im.youni.token.api.AccessKeyService/providers}) = error{path{/dubbo/im.youni.token.api.AccessKeyService/providers} has none children}
	[2016/08/11 17:22:19 CST] [EROR] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:187] watchDir(path{/dubbo/im.youni.token.api.AccessKeyService/providers}) = error{path{/dubbo/im.youni.token.api.AccessKeyService/providers} has none children}
	[2016/08/11 17:22:25 CST] [EROR] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:187] watchDir(path{/dubbo/im.youni.token.api.AccessKeyService/providers}) = error{path{/dubbo/im.youni.token.api.AccessKeyService/providers} has none children}
	[2016/08/11 17:22:34 CST] [EROR] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:187] watchDir(path{/dubbo/im.youni.token.api.AccessKeyService/providers}) = error{path{/dubbo/im.youni.token.api.AccessKeyService/providers} has none children}
	[2016/08/11 17:22:46 CST] [EROR] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:187] watchDir(path{/dubbo/im.youni.token.api.AccessKeyService/providers}) = error{path{/dubbo/im.youni.token.api.AccessKeyService/providers} has none children}
	[2016/08/11 17:23:01 CST] [EROR] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:187] watchDir(path{/dubbo/im.youni.token.api.AccessKeyService/providers}) = error{path{/dubbo/im.youni.token.api.AccessKeyService/providers} has none children}
	[2016/08/11 17:23:19 CST] [EROR] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:187] watchDir(path{/dubbo/im.youni.token.api.AccessKeyService/providers}) = error{path{/dubbo/im.youni.token.api.AccessKeyService/providers} has none children}
	[2016/08/11 17:23:40 CST] [EROR] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:187] watchDir(path{/dubbo/im.youni.token.api.AccessKeyService/providers}) = error{path{/dubbo/im.youni.token.api.AccessKeyService/providers} has none children}
	[2016/08/11 17:24:04 CST] [EROR] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:187] watchDir(path{/dubbo/im.youni.token.api.AccessKeyService/providers}) = error{path{/dubbo/im.youni.token.api.AccessKeyService/providers} has none children}
	[2016/08/11 17:24:31 CST] [EROR] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:187] watchDir(path{/dubbo/im.youni.token.api.AccessKeyService/providers}) = error{path{/dubbo/im.youni.token.api.AccessKeyService/providers} has none children}
	[2016/08/11 17:25:01 CST] [EROR] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:187] watchDir(path{/dubbo/im.youni.token.api.AccessKeyService/providers}) = error{path{/dubbo/im.youni.token.api.AccessKeyService/providers} has none children}
	[2016/08/11 17:25:31 CST] [EROR] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:187] watchDir(path{/dubbo/im.youni.token.api.AccessKeyService/providers}) = error{path{/dubbo/im.youni.token.api.AccessKeyService/providers} has none children}
	[2016/08/11 17:26:01 CST] [EROR] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:187] watchDir(path{/dubbo/im.youni.token.api.AccessKeyService/providers}) = error{path{/dubbo/im.youni.token.api.AccessKeyService/providers} has none children}
  
#### 2.1.2 观察 zk console ####
---

至zk查看相关目录结构如下:

    [zk: localhost:2201(CONNECTED) 1] ls /dubbo/im.youni.iccs.status.api.StatusUpdateService/consumers
    [jsonrpc%3A%2F%2F10.45.2.39%2Fim.youni.iccs.status.api.StatusUpdateService%3Fapplication%3DPalmChat%26category%3Dconsumer%26dubbo%3Ddubbo-consumer-golang-0.0.1%26group%3D%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26ip%3D10.45.2.39%26module%3Ddubbogo%2Bclient%26org%3Dzenmen.com%26owner%3DZX%26pid%3D6560%26revision%3D%26side%3Dconsumer%26timeout%3D120%26timestamp%3D1470723624%26version%3D]
    [zk: localhost:2201(CONNECTED) 2] ls /dubbo/im.youni.iccs.status.api.StatusUpdateService/providers
    []

> 从上面zk内容来看，相关服务确实没有注册上。

#### 2.1.3 启动status ####
---

启动status server后，cmg console log为：

	[08/09/16 16:13:55] [WARN] get a zookeeper event{zk.Event{Type:-1, State:1, Path:"", Err:error(nil), Server:"116.211.15.192:2201"}}, state{1}:zookeeper connecting
	2016/08/09 16:13:55 Connected to 116.211.15.192:2201
	2016/08/09 16:13:55 Authenticated: id=96384857520342091, timeout=40000
	[08/09/16 16:13:55] [DEBG] add serviceUrl{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.192:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.192", Port:"30880", Version:"", Group:"", Query:url.Values{"default.threads":[]string{"100"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "side":[]string{"provider"}, "timestamp":[]string{"1470730434282"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "dubbo":[]string{"2.5.3"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "pid":[]string{"10324"}, "revision":[]string{"0.0.5"}, "server":[]string{"jetty"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D10324%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470730434282"}}
	[08/09/16 16:13:55] [INFO] watch dubbo service key{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers/jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D10324%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470730434282}
	[08/09/16 16:13:55] [WARN] serviceURL{&registry.ServiceURL{Protocol:"dubbo", Location:"116.211.15.192:20880", Path:"/im.youni.iccs.status.api.StatusUpdateService", Ip:"116.211.15.192", Port:"20880", Version:"", Group:"", Query:url.Values{"timestamp":[]string{"1470730434200"}, "anyhost":[]string{"true"}, "default.threads":[]string{"100"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "revision":[]string{"0.0.5"}, "side":[]string{"provider"}, "application":[]string{"status-dubbo-p"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "pid":[]string{"10324"}}, Weight:0, PrimitiveURL:"dubbo%3A%2F%2F116.211.15.192%3A20880%2Fim.youni.iccs.status.api.StatusUpdateService%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D10324%26revision%3D0.0.5%26side%3Dprovider%26timestamp%3D1470730434200"}} is not compatible with ServiceConfig{registry.ServiceConfig{Protocol:"jsonrpc", Service:"im.youni.iccs.status.api.StatusUpdateService", Group:"", Version:""}}
	[08/09/16 16:13:55] [INFO] watch dubbo path{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers}
	[08/09/16 16:13:55] [DEBG] update @registry result{action:add service url, serviceURL:&{jsonrpc 116.211.15.192:30880 /im.youni.iccs.status.api.StatusUpdateService2 116.211.15.192 30880   map[default.threads:[100] interface:[im.youni.iccs.status.api.StatusUpdateService] side:[provider] methods:[logout,updateLocale,heartbeat,clearStatus,login0,login] pid:[10324] revision:[0.0.5] server:[jetty] timestamp:[1470730434282] anyhost:[true] application:[status-dubbo-p] dubbo:[2.5.3]] 0 jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D10324%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470730434282}}
	[08/09/16 16:13:55] [DEBG] service name:im.youni.iccs.status.api.StatusUpdateService, get service{[]*registry.ServiceURL(nil)} event
	[08/09/16 16:13:55] [INFO] selector add serviceURL{registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.192:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.192", Port:"30880", Version:"", Group:"", Query:url.Values{"default.threads":[]string{"100"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "side":[]string{"provider"}, "timestamp":[]string{"1470730434282"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "dubbo":[]string{"2.5.3"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "pid":[]string{"10324"}, "revision":[]string{"0.0.5"}, "server":[]string{"jetty"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D10324%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470730434282"}}

从log看出，status启动以后，cmg得到了zk通知，然后正常启动。   
此时cmg console log打印如下：   

	[08/09/16 17:09:44] [DEBG] @i{0}, call(ID{1446067877}, ctx{context.Background.WithValue("dubbogo-ctx", map[string]string{"X-Proxy-Id":"dubbogo", "X-Services":"im.youni.iccs.status.api.StatusUpdateService", "X-Method":"heartbeat"}).WithDeadline(2016-08-09 17:09:44.842629401 +0800 CST [496.03982ms])}, address{116.211.15.192:30880}, path{/im.youni.iccs.status.api.StatusUpdateService2}, request{&{im.youni.iccs.status.api.StatusUpdateService heartbeat application/json [0xc8200a2fc0] {false <nil>}}}, response{<nil>}) = err{<nil>}
	[08/09/16 17:09:48] [DEBG] @i{0}, call(ID{1446067878}, ctx{context.Background.WithValue("dubbogo-ctx", map[string]string{"X-Proxy-Id":"dubbogo", "X-Services":"im.youni.iccs.status.api.StatusUpdateService", "X-Method":"heartbeat"}).WithDeadline(2016-08-09 17:09:48.850971075 +0800 CST [496.175854ms])}, address{116.211.15.192:30880}, path{/im.youni.iccs.status.api.StatusUpdateService2}, request{&{im.youni.iccs.status.api.StatusUpdateService heartbeat application/json [0xc8200a3050] {false <nil>}}}, response{<nil>}) = err{<nil>}
	[08/09/16 17:09:49] [DEBG] @i{0}, call(ID{1446067879}, ctx{context.Background.WithValue("dubbogo-ctx", map[string]string{"X-Proxy-Id":"dubbogo", "X-Services":"im.youni.iccs.status.api.StatusUpdateService", "X-Method":"heartbeat"}).WithDeadline(2016-08-09 17:09:50.325131747 +0800 CST [495.778548ms])}, address{116.211.15.192:30880}, path{/im.youni.iccs.status.api.StatusUpdateService2}, request{&{im.youni.iccs.status.api.StatusUpdateService heartbeat application/json [0xc8200a30e0] {false <nil>}}}, response{<nil>}) = err{<nil>}


tcpdump抓包结果如下：

	17:13:18.825323 IP 116.211.15.192.59768 > 116.211.15.192.30880: Flags [P.], seq 1:630, ack 1, win 257, options [nop,nop,TS val 4275481323 ecr 4275481322], length 629
        0x0000:  4500 02a9 47b4 4000 4006 e774 74d3 0fc0  E...G.@.@..tt...
        0x0010:  74d3 0fc0 e978 78a0 e163 ed59 2102 6507  t....xx..c.Y!.e.
        0x0020:  8018 0101 0bc2 0000 0101 080a fed6 aaeb  ................
        0x0030:  fed6 aaea 504f 5354 202f 696d 2e79 6f75  ....POST./im.you
        0x0040:  6e69 2e69 6363 732e 7374 6174 7573 2e61  ni.iccs.status.a
        0x0050:  7069 2e53 7461 7475 7355 7064 6174 6553  pi.StatusUpdateS
        0x0060:  6572 7669 6365 3220 4854 5450 2f31 2e31  ervice2.HTTP/1.1
        0x0070:  0d0a 486f 7374 3a20 3131 362e 3231 312e  ..Host:.116.211.
        0x0080:  3135 2e31 3932 3a33 3038 3830 0d0a 5573  15.192:30880..Us
        0x0090:  6572 2d41 6765 6e74 3a20 476f 2d68 7474  er-Agent:.Go-htt
        0x00a0:  702d 636c 6965 6e74 2f31 2e31 0d0a 436f  p-client/1.1..Co
        0x00b0:  6e74 656e 742d 4c65 6e67 7468 3a20 3330  ntent-Length:.30
        0x00c0:  360d 0a41 6363 6570 743a 2061 7070 6c69  6..Accept:.appli
        0x00d0:  6361 7469 6f6e 2f6a 736f 6e0d 0a43 6f6e  cation/json..Con
        0x00e0:  7465 6e74 2d54 7970 653a 2061 7070 6c69  tent-Type:.appli
        0x00f0:  6361 7469 6f6e 2f6a 736f 6e0d 0a54 696d  cation/json..Tim
        0x0100:  656f 7574 3a20 3530 3030 3030 3030 300d  eout:.500000000.
        0x0110:  0a58 2d4d 6574 686f 643a 2068 6561 7274  .X-Method:.heart
        0x0120:  6265 6174 0d0a 582d 5072 6f78 792d 4964  beat..X-Proxy-Id
        0x0130:  3a20 6475 6262 6f67 6f0d 0a58 2d53 6572  :.dubbogo..X-Ser
        0x0140:  7669 6365 733a 2069 6d2e 796f 756e 692e  vices:.im.youni.
        0x0150:  6963 6373 2e73 7461 7475 732e 6170 692e  iccs.status.api.
        0x0160:  5374 6174 7573 5570 6461 7465 5365 7276  StatusUpdateServ
        0x0170:  6963 650d 0a0d 0a7b 226a 736f 6e72 7063  ice....{"jsonrpc
        0x0180:  223a 2232 2e30 222c 226d 6574 686f 6422  ":"2.0","method"
        0x0190:  3a22 6865 6172 7462 6561 7422 2c22 7061  :"heartbeat","pa
        0x01a0:  7261 6d73 223a 5b7b 226e 616d 6522 3a22  rams":[{"name":"
        0x01b0:  3939 3930 3030 3030 3030 3433 3430 3333  9990000000434033
        0x01c0:  222c 2273 6573 7369 6f6e 4964 223a 2232  ","sessionId":"2
        0x01d0:  2e33 3958 566c 427a 672d 6432 3866 6539  .39XVlBzg-d28fe9
        0x01e0:  6632 2d33 3236 382d 3465 3331 2d61 6138  f2-3268-4e31-aa8
        0x01f0:  622d 3832 3534 6563 6462 6536 6561 222c  b-8254ecdbe6ea",
        0x0200:  2272 6573 6f75 7263 6522 3a22 616e 6472  "resource":"andr
        0x0210:  6f69 6422 2c22 646f 6d61 696e 223a 2279  oid","domain":"y
        0x0220:  6f75 6e69 222c 2264 6576 6963 6549 6422  ouni","deviceId"
        0x0230:  3a22 3939 3930 3030 3030 3030 3433 3430  :"99900000004340
        0x0240:  3333 222c 2276 636f 6465 223a 2233 3322  33","vcode":"33"
        0x0250:  2c22 686f 7374 223a 2231 3136 2e32 3131  ,"host":"116.211
        0x0260:  2e31 352e 3138 3922 2c22 636c 6965 6e74  .15.189","client
        0x0270:  4970 223a 2231 3136 2e32 3131 2e31 352e  Ip":"116.211.15.
        0x0280:  3139 3222 2c22 6c6f 6361 6c65 223a 227a  192","locale":"z
        0x0290:  685f 434e 227d 5d2c 2269 6422 3a31 3434  h_CN"}],"id":144
        0x02a0:  3630 3637 3931 327d 0a                   6067912}.   
		17:13:18.825331 IP 116.211.15.192.30880 > 116.211.15.192.59768: Flags [.], ack 630, win 266, options [nop,nop,TS val 4275481323 ecr 4275481323], length 0
        0x0000:  4500 0034 cfed 4000 4006 61b0 74d3 0fc0  E..4..@.@.a.t...
        0x0010:  74d3 0fc0 78a0 e978 2102 6507 e163 efce  t...x..x!.e..c..
        0x0020:  8010 010a 5fb2 0000 0101 080a fed6 aaeb  ...._...........
        0x0030:  fed6 aaeb                                ....
		17:13:18.828839 IP 116.211.15.192.30880 > 116.211.15.192.59768: Flags [P.], seq 1:124, ack 630, win 266, options [nop,nop,TS val 4275481326 ecr 4275481323], length 123
        0x0000:  4500 00af cfee 4000 4006 6134 74d3 0fc0  E.....@.@.a4t...
        0x0010:  74d3 0fc0 78a0 e978 2102 6507 e163 efce  t...x..x!.e..c..
        0x0020:  8018 010a 09c8 0000 0101 080a fed6 aaee  ................
        0x0030:  fed6 aaeb 4854 5450 2f31 2e31 2032 3030  ....HTTP/1.1.200
        0x0040:  204f 4b0d 0a54 7261 6e73 6665 722d 456e  .OK..Transfer-En
        0x0050:  636f 6469 6e67 3a20 6368 756e 6b65 640d  coding:.chunked.
        0x0060:  0a53 6572 7665 723a 204a 6574 7479 2836  .Server:.Jetty(6
        0x0070:  2e31 2e32 3629 0d0a 0d0a 3246 0d0a 7b22  .1.26)....2F..{"
        0x0080:  6a73 6f6e 7270 6322 3a22 322e 3022 2c22  jsonrpc":"2.0","
        0x0090:  6964 223a 3134 3436 3036 3739 3132 2c22  id":1446067912,"
        0x00a0:  7265 7375 6c74 223a 6e75 6c6c 7d0d 0a    result":null}..

### 2.2 有cmg & zk & status，再添加一个status ###
---

本测试的目的是查看添加status后，dubbogo能否获取新的status。

注意：本次测试中的操作承接2.1中的操作。

#### 2.2.1 启动第二个status ####
---

添加新的status之后，同上，先呈上cmg的log：
	
	[08/09/16 17:38:22] [INFO] add zkNode{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers/dubbo%3A%2F%2F116.211.15.191%3A20880%2Fim.youni.iccs.status.api.StatusUpdateService%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D14014%26revision%3D0.0.5%26side%3Dprovider%26timestamp%3D1470735502506}
	[08/09/16 17:38:22] [WARN] serviceURL{&registry.ServiceURL{Protocol:"dubbo", Location:"116.211.15.191:20880", Path:"/im.youni.iccs.status.api.StatusUpdateService", Ip:"116.211.15.191", Port:"20880", Version:"", Group:"", Query:url.Values{"application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "anyhost":[]string{"true"}, "dubbo":[]string{"2.5.3"}, "pid":[]string{"14014"}, "revision":[]string{"0.0.5"}, "side":[]string{"provider"}, "timestamp":[]string{"1470735502506"}}, Weight:0, PrimitiveURL:"dubbo%3A%2F%2F116.211.15.191%3A20880%2Fim.youni.iccs.status.api.StatusUpdateService%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D14014%26revision%3D0.0.5%26side%3Dprovider%26timestamp%3D1470735502506"}} is not compatible with ServiceConfig{registry.ServiceConfig{Protocol:"jsonrpc", Service:"im.youni.iccs.status.api.StatusUpdateService", Group:"", Version:""}}
	[08/09/16 17:38:22] [INFO] add zkNode{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers/jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D14014%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470735502654}
	[08/09/16 17:38:22] [INFO] add serviceURL{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "pid":[]string{"14014"}, "revision":[]string{"0.0.5"}, "server":[]string{"jetty"}, "timestamp":[]string{"1470735502654"}, "anyhost":[]string{"true"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "side":[]string{"provider"}, "dubbo":[]string{"2.5.3"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D14014%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470735502654"}}
	[08/09/16 17:38:22] [INFO] delete zkNode{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers/jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D14014%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470735502654}
	[08/09/16 17:38:22] [DEBG] update @registry result{action:add service url, serviceURL:&{jsonrpc 116.211.15.191:30880 /im.youni.iccs.status.api.StatusUpdateService2 116.211.15.191 30880   map[side:[provider] dubbo:[2.5.3] interface:[im.youni.iccs.status.api.StatusUpdateService] methods:[logout,updateLocale,heartbeat,clearStatus,login0,login] pid:[14014] revision:[0.0.5] server:[jetty] timestamp:[1470735502654] anyhost:[true] application:[status-dubbo-p] default.threads:[100]] 0 jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D14014%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470735502654}}
	[08/09/16 17:38:22] [INFO] selector add serviceURL{registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "side":[]string{"provider"}, "server":[]string{"jetty"}, "timestamp":[]string{"1470735502654"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "pid":[]string{"14014"}, "revision":[]string{"0.0.5"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D14014%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470735502654"}}

zk内部路径变化如下：

	[zk: localhost:2201(CONNECTED) 3] ls /dubbo/im.youni.iccs.status.api.StatusUpdateService/providers
	[jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D10324%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470730434282, dubbo%3A%2F%2F116.211.15.192%3A20880%2Fim.youni.iccs.status.api.StatusUpdateService%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D10324%26revision%3D0.0.5%26side%3Dprovider%26timestamp%3D1470730434200]
	[zk: localhost:2201(CONNECTED) 4] ls /dubbo/im.youni.iccs.status.api.StatusUpdateService/providers
	[jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D10324%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470730434282, jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D14014%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470735502654, dubbo%3A%2F%2F116.211.15.191%3A20880%2Fim.youni.iccs.status.api.StatusUpdateService%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D14014%26revision%3D0.0.5%26side%3Dprovider%26timestamp%3D1470735502506, dubbo%3A%2F%2F116.211.15.192%3A20880%2Fim.youni.iccs.status.api.StatusUpdateService%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D10324%26revision%3D0.0.5%26side%3Dprovider%26timestamp%3D1470730434200]

从zk路径来看，新的status确实添加成功，从cmg的日志来看，新的status添加后它立即收到了zk的event，而且自身的服务列表也更新成功。

### 2.3 有cmg & zk & status，无token，但在dubbo.toml中配置上token服务接口 ###
---

本测试的目的是查看在不使用token服务的情况下把token服务的接口放进cmg的配置文件cmg/conf/dubbo.toml后，dubbogo能否稳定运行。[这个情况是无意间发现的一个bug，已经修正，在这里作为一个测试case]

注意：本次测试中的操作承接2.2中的操作。

#### 2.3.1 配置cmg/conf/dubbo.toml ####
---

	[[Service_List]]
	    Protocol            = "jsonrpc"
	    Service             = "im.youni.token.api.AccessKeyService"
	
	[[Service_List]]
	    Protocol            = "jsonrpc"
	    Service             = "im.youni.iccs.status.api.StatusUpdateService"

本次测试中只使用了StatusUpdateService,但是配置文件中把AccessKeyService添加了进去。

#### 2.3.2 观察cmg/logs/debug.log ####
---

在bug修复之前，debug.log的内容如下：
	
	[2016/08/09 21:49:01 CST] [INFO] [dubbogo/registry/zk.newZookeeperClient.func1.1:98] zk{path:[116.211.15.192:2201], name:watcher zk registry} connection goroutine game over.
	[2016/08/09 21:49:01 CST] [WARN] [dubbogo/registry/zk.(*zookeeperClient).Close:153] zk client{name:watcher zk registry, zk addr:[116.211.15.192:2201]} exit now.
	[2016/08/09 21:49:01 CST] [WARN] [dubbogo/selector/cache.(*cacheSelector).run:205] cacheSelector.watch() = error{path{/dubbo/im.youni.token.api.AccessKeyService/providers} has none children}

从log可以看出，这个bug导致consumerZookeeperRegistry不断地退出重启。   
修改bug后，debug.log内容如下：

	[2016/08/10 13:35:03 CST] [EROR] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:106] watchDir(path{/dubbo/im.youni.token.api.AccessKeyService/providers}) = error{path{/dubbo/im.youni.token.api.AccessKeyService/providers} has none children}

修复后的dubbogo只会不断报告zk path "/dubbo/im.youni.token.api.AccessKeyService/providers"下面没有nodes，不会引发其他bug。

### 2.4 有cmg & zk & 两个status，服务稳定的情况下关闭一个status ###
---

本测试的目的是观察关闭一个status的情况下，cmg能否继续体统稳定的服务。

同样的，本测试承接上面的测试。

#### 2.4.1 关闭一个status之前，zk相关路径 ####
---

	[zk: localhost:2201(CONNECTED) 4] ls /dubbo/im.youni.iccs.status.api.StatusUpdateService/providers
	[jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D10324%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470730434282, jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D14014%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470735502654, dubbo%3A%2F%2F116.211.15.191%3A20880%2Fim.youni.iccs.status.api.StatusUpdateService%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D14014%26revision%3D0.0.5%26side%3Dprovider%26timestamp%3D1470735502506, dubbo%3A%2F%2F116.211.15.192%3A20880%2Fim.youni.iccs.status.api.StatusUpdateService%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D10324%26revision%3D0.0.5%26side%3Dprovider%26timestamp%3D1470730434200]

从上面路径可以看出，测试之前有两个status能否提供jsonrpc服务。

#### 2.4.2 关闭一个status之后，zk相关路径以及cmg/logs/debug.log ####
---

zk path如下：

	[zk: localhost:2201(CONNECTED) 5] ls /dubbo/im.youni.iccs.status.api.StatusUpdateService/providers
	[jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D10324%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470730434282, dubbo%3A%2F%2F116.211.15.192%3A20880%2Fim.youni.iccs.status.api.StatusUpdateService%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D10324%26revision%3D0.0.5%26side%3Dprovider%26timestamp%3D1470730434200]

从上面的path内容可以看出，116.211.15.191这个机器的status已经不存在了。   
同时，cmg/logs/debug.log记录的dubbogo更定服务provider过程如下：

	[2016/08/10 14:14:36 CST] [WARN] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:117] get a zookeeper event{zk.Event{Type:4, State:3, Path:"/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers", Err:error(nil), Server:""}}, state{3}:zookeeper node data changed
	[2016/08/10 14:14:36 CST] [WARN] [dubbogo/registry/zk.newZookeeperClient.func1:107] get a zookeeper event{zk.Event{Type:2, State:3, Path:"/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers/jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D14014%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470735502654", Err:error(nil), Server:""}}, state{3}:zookeeper node data changed
	[2016/08/10 14:14:36 CST] [WARN] [dubbogo/registry/zk.(*zookeeperWatcher).watchServiceNode:72] get a zookeeper event{zk.Event{Type:2, State:3, Path:"/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers/jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D14014%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470735502654", Err:error(nil), Server:""}}, state{3}:zookeeper node data changed
	[2016/08/10 14:14:36 CST] [WARN] [dubbogo/registry/zk.(*zookeeperWatcher).watchServiceNode:81] zk.ExistW(key{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers/jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D14014%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470735502654}) = event{EventNodeDeleted}
	[2016/08/10 14:14:36 CST] [WARN] [dubbogo/registry/zk.(*zookeeperWatcher).watchServiceNode:72] get a zookeeper event{zk.Event{Type:2, State:3, Path:"/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers/jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D14014%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470735502654", Err:error(nil), Server:""}}, state{3}:zookeeper node data changed
	[2016/08/10 14:14:36 CST] [DEBG] [dubbogo/registry/zk.(*zookeeperWatcher).watchService.func1:228] delete serviceUrl{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.192:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.192", Port:"30880", Version:"", Group:"", Query:url.Values{"anyhost":[]string{"true"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "revision":[]string{"0.0.5"}, "timestamp":[]string{"1470730434282"}, "pid":[]string{"10324"}, "server":[]string{"jetty"}, "side":[]string{"provider"}, "application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D10324%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470730434282"}}
	[2016/08/10 14:14:36 CST] [WARN] [dubbogo/registry/zk.(*zookeeperWatcher).watchService.func1:230] watchSelf(zk path{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers/jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D10324%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470730434282}) goroutine exit now
	[2016/08/10 14:14:36 CST] [WARN] [dubbogo/registry/zk.(*zookeeperWatcher).watchServiceNode:81] zk.ExistW(key{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers/jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D14014%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470735502654}) = event{EventNodeDeleted}
	[2016/08/10 14:14:36 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).watch:274] watch.Next() = result{&registry.Result{Action:1, Service:(*registry.ServiceURL)(0xc8201e4240)}}, error{<nil>}
	[2016/08/10 14:14:36 CST] [DEBG] [dubbogo/registry/zk.(*zookeeperWatcher).watchService.func1:228] delete serviceUrl{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"application":[]string{"status-dubbo-p"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "side":[]string{"provider"}, "timestamp":[]string{"1470735502654"}, "anyhost":[]string{"true"}, "dubbo":[]string{"2.5.3"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "pid":[]string{"14014"}, "revision":[]string{"0.0.5"}, "server":[]string{"jetty"}, "default.threads":[]string{"100"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D14014%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470735502654"}}
	[2016/08/10 14:14:36 CST] [WARN] [dubbogo/registry/zk.(*zookeeperWatcher).watchService.func1:230] watchSelf(zk path{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers/jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D14014%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470735502654}) goroutine exit now
	[2016/08/10 14:14:36 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:139] update @registry result{action:delete service url, serviceURL:&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.192:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.192", Port:"30880", Version:"", Group:"", Query:url.Values{"pid":[]string{"10324"}, "server":[]string{"jetty"}, "side":[]string{"provider"}, "application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "anyhost":[]string{"true"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "revision":[]string{"0.0.5"}, "timestamp":[]string{"1470730434282"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D10324%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470730434282"}}
	[2016/08/10 14:14:36 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:145] service name:im.youni.iccs.status.api.StatusUpdateService, get service{[]*registry.ServiceURL{(*registry.ServiceURL)(0xc820b69e60), (*registry.ServiceURL)(0xc820b69ef0)}} event
	[2016/08/10 14:14:36 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:146] before update, cache.services[im.youni.iccs.status.api.StatusUpdateService] member lists:
	[2016/08/10 14:14:36 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:150] cache.services[im.youni.iccs.status.api.StatusUpdateService][0] = service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.192:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.192", Port:"30880", Version:"", Group:"", Query:url.Values{"interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "revision":[]string{"0.0.5"}, "dubbo":[]string{"2.5.3"}, "pid":[]string{"10324"}, "server":[]string{"jetty"}, "side":[]string{"provider"}, "timestamp":[]string{"1470730434282"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D10324%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470730434282"}}
	[2016/08/10 14:14:36 CST] [WARN] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:168] delete zkPath{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers/jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D14014%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470735502654}
	[2016/08/10 14:14:36 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:150] cache.services[im.youni.iccs.status.api.StatusUpdateService][1] = service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "pid":[]string{"14014"}, "revision":[]string{"0.0.5"}, "server":[]string{"jetty"}, "side":[]string{"provider"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "timestamp":[]string{"1470735502654"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D14014%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470735502654"}}
	[2016/08/10 14:14:36 CST] [EROR] [dubbogo/selector/cache.(*cacheSelector).update:162] selector delete serviceURL{registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.192:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.192", Port:"30880", Version:"", Group:"", Query:url.Values{"anyhost":[]string{"true"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "revision":[]string{"0.0.5"}, "timestamp":[]string{"1470730434282"}, "application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "pid":[]string{"10324"}, "server":[]string{"jetty"}, "side":[]string{"provider"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D10324%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470730434282"}}
	[2016/08/10 14:14:36 CST] [WARN] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:170] delete serviceURL{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"pid":[]string{"14014"}, "default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "revision":[]string{"0.0.5"}, "server":[]string{"jetty"}, "side":[]string{"provider"}, "timestamp":[]string{"1470735502654"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D14014%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470735502654"}}
	[2016/08/10 14:14:36 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:165] after update, cache.services[im.youni.iccs.status.api.StatusUpdateService] member lists:
	[2016/08/10 14:14:36 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:168] cache.services[im.youni.iccs.status.api.StatusUpdateService][0] = service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"dubbo":[]string{"2.5.3"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "timestamp":[]string{"1470735502654"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "server":[]string{"jetty"}, "side":[]string{"provider"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "pid":[]string{"14014"}, "revision":[]string{"0.0.5"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D14014%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470735502654"}}
	[2016/08/10 14:14:36 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).watch:274] watch.Next() = result{&registry.Result{Action:1, Service:(*registry.ServiceURL)(0xc8201e4360)}}, error{<nil>}
	[2016/08/10 14:14:36 CST] [WARN] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:168] delete zkPath{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers/dubbo%3A%2F%2F116.211.15.191%3A20880%2Fim.youni.iccs.status.api.StatusUpdateService%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D14014%26revision%3D0.0.5%26side%3Dprovider%26timestamp%3D1470735502506}
	[2016/08/10 14:14:36 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:139] update @registry result{action:delete service url, serviceURL:&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "side":[]string{"provider"}, "timestamp":[]string{"1470735502654"}, "default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "pid":[]string{"14014"}, "revision":[]string{"0.0.5"}, "server":[]string{"jetty"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D14014%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470735502654"}}

从下面这个cmg/logs/debug.log中的一条log可以看出，服务没有受到影响：

	[2016/08/10 14:25:37 CST] [DEBG] [dubbogo/client.(*rpcClient).Call.func1:295] @i{0}, call(ID{20340705954}, ctx{context.Background.WithValue("dubbogo-ctx", map[string]string{"X-Proxy-Id":"dubbogo", "X-Services":"im.youni.iccs.status.api.StatusUpdateService", "X-Method":"heartbeat"}).WithDeadline(2016-08-10 14:25:37.501990239 +0800 CST [495.451042ms])}, address{116.211.15.192:30880}, path{/im.youni.iccs.status.api.StatusUpdateService2}, request{&{im.youni.iccs.status.api.StatusUpdateService heartbeat application/json [0xc8205486c0] {false <nil>}}}, response{<nil>}) = err{<nil>}

### 2.5 有cmg & zk & status的情况下，重启status ###
---

本次测试承接上面2.4的测试，在只剩下一个status的情况下，把status重启一下，查看dubbogo服务的稳定性。

#### 2.5.1 关闭status ####
---

zk路径变为:

	[zk: localhost:2201(CONNECTED) 9] ls /dubbo/im.youni.iccs.status.api.StatusUpdateService/providers
	[]

cmg/logs/debug.log:
	
	[2016/08/10 20:06:40 CST] [WARN] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:127] get a zookeeper event{zk.Event{Type:4, State:3, Path:"/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers", Err:error(nil), Server:""}}, state{3-zookeeper node data changed}
	[2016/08/10 20:06:40 CST] [WARN] [dubbogo/registry/zk.newZookeeperClient.func1:106] get a zookeeper event{zk.Event{Type:2, State:3, Path:"/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers/jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D976%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470830717850", Err:error(nil), Server:""}}, state{3}:zookeeper node data changed
	[2016/08/10 20:06:40 CST] [WARN] [dubbogo/registry/zk.newZookeeperClient.func1:106] get a zookeeper event{zk.Event{Type:4, State:3, Path:"/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers", Err:error(nil), Server:""}}, state{3}:zookeeper node data changed
	[2016/08/10 20:06:40 CST] [WARN] [dubbogo/registry/zk.(*zookeeperWatcher).watchServiceNode:73] get a zookeeper event{zk.Event{Type:2, State:3, Path:"/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers/jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D976%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470830717850", Err:error(nil), Server:""}}, state{3-zookeeper node data changed}
	[2016/08/10 20:06:40 CST] [WARN] [dubbogo/registry/zk.(*zookeeperWatcher).watchServiceNode:73] get a zookeeper event{zk.Event{Type:2, State:3, Path:"/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers/jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D976%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470830717850", Err:error(nil), Server:""}}, state{3-zookeeper node data changed}
	[2016/08/10 20:06:40 CST] [WARN] [dubbogo/registry/zk.(*zookeeperWatcher).watchServiceNode:82] zk.ExistW(key{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers/jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D976%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470830717850}) = event{EventNodeDeleted}
	[2016/08/10 20:06:40 CST] [WARN] [dubbogo/registry/zk.(*zookeeperWatcher).watchServiceNode:82] zk.ExistW(key{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers/jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D976%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470830717850}) = event{EventNodeDeleted}
	[2016/08/10 20:06:40 CST] [DEBG] [dubbogo/registry/zk.(*zookeeperWatcher).watchService.func1:244] delete serviceUrl{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "revision":[]string{"0.0.5"}, "side":[]string{"provider"}, "timestamp":[]string{"1470830717850"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "pid":[]string{"976"}, "server":[]string{"jetty"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D976%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470830717850"}}
	[2016/08/10 20:06:40 CST] [DEBG] [dubbogo/registry/zk.(*zookeeperWatcher).watchService.func1:244] delete serviceUrl{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.192:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.192", Port:"30880", Version:"", Group:"", Query:url.Values{"server":[]string{"jetty"}, "application":[]string{"status-dubbo-p"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "pid":[]string{"32112"}, "side":[]string{"provider"}, "timestamp":[]string{"1470830710990"}, "anyhost":[]string{"true"}, "default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "revision":[]string{"0.0.5"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D32112%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470830710990"}}
	[2016/08/10 20:06:40 CST] [WARN] [dubbogo/registry/zk.(*zookeeperWatcher).watchService.func1:247] watchSelf(zk path{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers/jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D976%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470830717850}) goroutine exit now
	[2016/08/10 20:06:40 CST] [WARN] [dubbogo/registry/zk.(*zookeeperWatcher).watchService.func1:247] watchSelf(zk path{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers/jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D32112%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470830710990}) goroutine exit now
	[2016/08/10 20:06:40 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).watch:285] watch.Next() = result{Result{Action{delete service url}, Service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"revision":[]string{"0.0.5"}, "side":[]string{"provider"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "pid":[]string{"976"}, "server":[]string{"jetty"}, "timestamp":[]string{"1470830717850"}, "anyhost":[]string{"true"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D976%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470830717850"}}}}, error{<nil>}
	[2016/08/10 20:06:40 CST] [WARN] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:180] delete zkPath{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers/jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D976%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470830717850}
	[2016/08/10 20:06:40 CST] [WARN] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:186] delete serviceURL{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "pid":[]string{"976"}, "revision":[]string{"0.0.5"}, "server":[]string{"jetty"}, "anyhost":[]string{"true"}, "dubbo":[]string{"2.5.3"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "side":[]string{"provider"}, "timestamp":[]string{"1470830717850"}, "application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D976%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470830717850"}}
	[2016/08/10 20:06:40 CST] [WARN] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:180] delete zkPath{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers/jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D976%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470830717850}
	[2016/08/10 20:06:40 CST] [WARN] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:186] delete serviceURL{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "pid":[]string{"976"}, "revision":[]string{"0.0.5"}, "server":[]string{"jetty"}, "anyhost":[]string{"true"}, "dubbo":[]string{"2.5.3"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "side":[]string{"provider"}, "timestamp":[]string{"1470830717850"}, "application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D976%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470830717850"}}
	[2016/08/10 20:06:40 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:151] update @registry result{Result{Action{delete service url}, Service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"pid":[]string{"976"}, "server":[]string{"jetty"}, "timestamp":[]string{"1470830717850"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "revision":[]string{"0.0.5"}, "side":[]string{"provider"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D976%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470830717850"}}}}
	[2016/08/10 20:06:40 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:155] service name:im.youni.iccs.status.api.StatusUpdateService, get service{[]*registry.ServiceURL{(*registry.ServiceURL)(0xc8201b6510)}} event, its current member lists:
	[2016/08/10 20:06:40 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:158] cache.services[im.youni.iccs.status.api.StatusUpdateService][0] = service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "pid":[]string{"976"}, "server":[]string{"jetty"}, "timestamp":[]string{"1470830717850"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "revision":[]string{"0.0.5"}, "side":[]string{"provider"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D976%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470830717850"}}
	[2016/08/10 20:06:40 CST] [EROR] [dubbogo/selector/cache.(*cacheSelector).update:170] selector delete serviceURL{registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "pid":[]string{"976"}, "server":[]string{"jetty"}, "timestamp":[]string{"1470830717850"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "revision":[]string{"0.0.5"}, "side":[]string{"provider"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D976%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470830717850"}}
	[2016/08/10 20:06:40 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:174] after update, cache.services[im.youni.iccs.status.api.StatusUpdateService] member list size{0}
	[2016/08/10 20:06:40 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).watch:285] watch.Next() = result{Result{Action{delete service url}, Service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.192:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.192", Port:"30880", Version:"", Group:"", Query:url.Values{"revision":[]string{"0.0.5"}, "side":[]string{"provider"}, "timestamp":[]string{"1470830710990"}, "anyhost":[]string{"true"}, "default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "pid":[]string{"32112"}, "server":[]string{"jetty"}, "application":[]string{"status-dubbo-p"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D32112%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470830710990"}}}}, error{<nil>}
	[2016/08/10 20:06:40 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:151] update @registry result{Result{Action{delete service url}, Service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.192:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.192", Port:"30880", Version:"", Group:"", Query:url.Values{"side":[]string{"provider"}, "timestamp":[]string{"1470830710990"}, "anyhost":[]string{"true"}, "default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "revision":[]string{"0.0.5"}, "server":[]string{"jetty"}, "application":[]string{"status-dubbo-p"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "pid":[]string{"32112"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D32112%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470830710990"}}}}
	[2016/08/10 20:06:40 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:155] service name:im.youni.iccs.status.api.StatusUpdateService, get service{[]*registry.ServiceURL(nil)} event, its current member lists:
	[2016/08/10 20:06:40 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).watch:285] watch.Next() = result{Result{Action{delete service url}, Service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.192:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.192", Port:"30880", Version:"", Group:"", Query:url.Values{"revision":[]string{"0.0.5"}, "side":[]string{"provider"}, "timestamp":[]string{"1470830710990"}, "anyhost":[]string{"true"}, "default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "pid":[]string{"32112"}, "server":[]string{"jetty"}, "application":[]string{"status-dubbo-p"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D32112%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470830710990"}}}}, error{<nil>}
	[2016/08/10 20:06:40 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:151] update @registry result{Result{Action{delete service url}, Service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.192:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.192", Port:"30880", Version:"", Group:"", Query:url.Values{"side":[]string{"provider"}, "timestamp":[]string{"1470830710990"}, "anyhost":[]string{"true"}, "default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "revision":[]string{"0.0.5"}, "server":[]string{"jetty"}, "application":[]string{"status-dubbo-p"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "pid":[]string{"32112"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D32112%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470830710990"}}}}
	[2016/08/10 20:06:40 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:155] service name:im.youni.iccs.status.api.StatusUpdateService, get service{[]*registry.ServiceURL(nil)} event, its current member lists:
	[2016/08/10 20:06:40 CST] [EROR] [dubbogo/selector/cache.(*cacheSelector).update:170] selector delete serviceURL{registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.192:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.192", Port:"30880", Version:"", Group:"", Query:url.Values{"default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "revision":[]string{"0.0.5"}, "side":[]string{"provider"}, "timestamp":[]string{"1470830710990"}, "anyhost":[]string{"true"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "pid":[]string{"32112"}, "server":[]string{"jetty"}, "application":[]string{"status-dubbo-p"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D32112%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470830710990"}}
	[2016/08/10 20:06:40 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:174] after update, cache.services[im.youni.iccs.status.api.StatusUpdateService] member list size{0}
	[2016/08/10 20:06:40 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).watch:285] watch.Next() = result{Result{Action{delete service url}, Service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "side":[]string{"provider"}, "timestamp":[]string{"1470830717850"}, "anyhost":[]string{"true"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "pid":[]string{"976"}, "revision":[]string{"0.0.5"}, "server":[]string{"jetty"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D976%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470830717850"}}}}, error{<nil>}
	[2016/08/10 20:06:40 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:151] update @registry result{Result{Action{delete service url}, Service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "side":[]string{"provider"}, "timestamp":[]string{"1470830717850"}, "anyhost":[]string{"true"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "pid":[]string{"976"}, "revision":[]string{"0.0.5"}, "server":[]string{"jetty"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D976%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470830717850"}}}}
	[2016/08/10 20:06:40 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:155] service name:im.youni.iccs.status.api.StatusUpdateService, get service{[]*registry.ServiceURL(nil)} event, its current member lists:
	[2016/08/10 20:06:40 CST] [EROR] [dubbogo/selector/cache.(*cacheSelector).update:170] selector delete serviceURL{registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"anyhost":[]string{"true"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "pid":[]string{"976"}, "revision":[]string{"0.0.5"}, "server":[]string{"jetty"}, "application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "side":[]string{"provider"}, "timestamp":[]string{"1470830717850"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D976%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470830717850"}}
	[2016/08/10 20:06:40 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:174] after update, cache.services[im.youni.iccs.status.api.StatusUpdateService] member list size{0}
	[2016/08/10 20:06:40 CST] [EROR] [dubbogo/selector/cache.(*cacheSelector).update:170] selector delete serviceURL{registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.192:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.192", Port:"30880", Version:"", Group:"", Query:url.Values{"default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "revision":[]string{"0.0.5"}, "side":[]string{"provider"}, "timestamp":[]string{"1470830710990"}, "anyhost":[]string{"true"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "pid":[]string{"32112"}, "server":[]string{"jetty"}, "application":[]string{"status-dubbo-p"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D32112%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470830710990"}}
	[2016/08/10 20:06:40 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:174] after update, cache.services[im.youni.iccs.status.api.StatusUpdateService] member list size{0}
	[2016/08/10 20:06:40 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).watch:285] watch.Next() = result{Result{Action{delete service url}, Service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "side":[]string{"provider"}, "timestamp":[]string{"1470830717850"}, "anyhost":[]string{"true"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "pid":[]string{"976"}, "revision":[]string{"0.0.5"}, "server":[]string{"jetty"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D976%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470830717850"}}}}, error{<nil>}
	[2016/08/10 20:06:40 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:151] update @registry result{Result{Action{delete service url}, Service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "side":[]string{"provider"}, "timestamp":[]string{"1470830717850"}, "anyhost":[]string{"true"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "pid":[]string{"976"}, "revision":[]string{"0.0.5"}, "server":[]string{"jetty"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D976%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470830717850"}}}}
	[2016/08/10 20:06:40 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:155] service name:im.youni.iccs.status.api.StatusUpdateService, get service{[]*registry.ServiceURL(nil)} event, its current member lists:
	[2016/08/10 20:06:40 CST] [EROR] [dubbogo/selector/cache.(*cacheSelector).update:170] selector delete serviceURL{registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"anyhost":[]string{"true"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "pid":[]string{"976"}, "revision":[]string{"0.0.5"}, "server":[]string{"jetty"}, "application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "side":[]string{"provider"}, "timestamp":[]string{"1470830717850"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D976%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470830717850"}}
	[2016/08/10 20:06:40 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:174] after update, cache.services[im.youni.iccs.status.api.StatusUpdateService] member list size{0}

从以上log来看，最后一个status被关闭后，status提供的jsonrpc和dubbo两种协议的zk node都别删除了，同时dubbogo正确地过滤掉了dubbo协议的event通知，只删除掉了jsonrpc对应的serviceURL。

此时dubbogo开始循环监控相关的zk path，cmg/logs/debug.log的内容如下：
	
	[2016/08/10 21:17:59 CST] [EROR] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:114] watchDir(path{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers}) = error{path{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers} has none children}
	[2016/08/10 21:18:08 CST] [EROR] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:114] watchDir(path{/dubbo/im.youni.token.api.AccessKeyService/providers}) = error{path{/dubbo/im.youni.token.api.AccessKeyService/providers} has none children}
	[2016/08/10 21:18:11 CST] [EROR] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:114] watchDir(path{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers}) = error{path{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers} has none children}
	[2016/08/10 21:18:26 CST] [EROR] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:114] watchDir(path{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers}) = error{path{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers} has none children}
	[2016/08/10 21:18:32 CST] [EROR] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:114] watchDir(path{/dubbo/im.youni.token.api.AccessKeyService/providers}) = error{path{/dubbo/im.youni.token.api.AccessKeyService/providers} has none children}

#### 2.5.2 再依次启动两个status ####
---

启动第一个status后，cmg/logs/debug.log的内容如下：

	[2016/08/11 11:41:58 CST] [EROR] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:187] watchDir(path{/dubbo/im.youni.token.api.AccessKeyService/providers}) = error{path{/dubbo/im.youni.token.api.AccessKeyService/providers} has none children}
	[2016/08/11 11:41:59 CST] [EROR] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:187] watchDir(path{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers}) = error{path{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers} has none children}
	[2016/08/11 11:42:11 CST] [EROR] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:187] watchDir(path{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers}) = error{path{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers} has none children}
	[2016/08/11 11:42:11 CST] [WARN] [dubbogo/registry/zk.newZookeeperClient.func1:112] get a zookeeper event{zk.Event{Type:4, State:3, Path:"/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers", Err:error(nil), Server:""}}, state{3}:zookeeper node data changed
	[2016/08/11 11:42:11 CST] [INFO] [dubbogo/registry/zk.newZookeeperClient.func1:125] zkClient get zk node changed event{path:/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers}
	[2016/08/11 11:42:11 CST] [INFO] [dubbogo/registry/zk.newZookeeperClient.func1:129] send event{state:zk.EventNodeDataChange, Path:/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers} notify event to path{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers} related watcher
	[2016/08/11 11:42:11 CST] [INFO] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:208] get zk.EventNodeDataChange notify event
	[2016/08/11 11:42:11 CST] [INFO] [dubbogo/registry/zk.(*zookeeperWatcher).handleZkNodeEvent:117] add zkNode{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers/dubbo%3A%2F%2F116.211.15.191%3A20880%2Fim.youni.iccs.status.api.StatusUpdateService%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D13899%26revision%3D0.0.5%26side%3Dprovider%26timestamp%3D1470886932320}
	[2016/08/11 11:42:11 CST] [WARN] [dubbogo/registry/zk.(*zookeeperWatcher).handleZkNodeEvent:124] serviceURL{&registry.ServiceURL{Protocol:"dubbo", Location:"116.211.15.191:20880", Path:"/im.youni.iccs.status.api.StatusUpdateService", Ip:"116.211.15.191", Port:"20880", Version:"", Group:"", Query:url.Values{"application":[]string{"status-dubbo-p"}, "dubbo":[]string{"2.5.3"}, "side":[]string{"provider"}, "timestamp":[]string{"1470886932320"}, "anyhost":[]string{"true"}, "default.threads":[]string{"100"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "pid":[]string{"13899"}, "revision":[]string{"0.0.5"}}, Weight:0, PrimitiveURL:"dubbo%3A%2F%2F116.211.15.191%3A20880%2Fim.youni.iccs.status.api.StatusUpdateService%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D13899%26revision%3D0.0.5%26side%3Dprovider%26timestamp%3D1470886932320"}} is not compatible with ServiceConfig{registry.ServiceConfig{Protocol:"jsonrpc", Service:"im.youni.iccs.status.api.StatusUpdateService", Group:"", Version:""}}
	[2016/08/11 11:42:12 CST] [WARN] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:218] get a zookeeper event{zk.Event{Type:4, State:3, Path:"/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers", Err:error(nil), Server:""}}, state{3-zookeeper node data changed}
	[2016/08/11 11:42:12 CST] [WARN] [dubbogo/registry/zk.newZookeeperClient.func1:112] get a zookeeper event{zk.Event{Type:4, State:3, Path:"/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers", Err:error(nil), Server:""}}, state{3}:zookeeper node data changed
	[2016/08/11 11:42:12 CST] [INFO] [dubbogo/registry/zk.newZookeeperClient.func1:125] zkClient get zk node changed event{path:/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers}
	[2016/08/11 11:42:12 CST] [INFO] [dubbogo/registry/zk.(*zookeeperWatcher).handleZkNodeEvent:117] add zkNode{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers/jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D13899%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470886932407}
	[2016/08/11 11:42:12 CST] [INFO] [dubbogo/registry/zk.(*zookeeperWatcher).handleZkNodeEvent:127] add serviceURL{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "pid":[]string{"13899"}, "timestamp":[]string{"1470886932407"}, "anyhost":[]string{"true"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "revision":[]string{"0.0.5"}, "server":[]string{"jetty"}, "side":[]string{"provider"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D13899%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470886932407"}}
	[2016/08/11 11:42:12 CST] [INFO] [dubbogo/registry/zk.(*zookeeperWatcher).handleZkNodeEvent.func1:131] delete zkNode{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers/jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D13899%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470886932407}
	[2016/08/11 11:42:12 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).watch:285] watch.Next() = result{Result{Action{add service url}, Service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "pid":[]string{"13899"}, "application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "server":[]string{"jetty"}, "side":[]string{"provider"}, "timestamp":[]string{"1470886932407"}, "anyhost":[]string{"true"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "revision":[]string{"0.0.5"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D13899%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470886932407"}}}}, error{<nil>}
	[2016/08/11 11:42:12 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:151] update @registry result{Result{Action{add service url}, Service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"server":[]string{"jetty"}, "side":[]string{"provider"}, "timestamp":[]string{"1470886932407"}, "anyhost":[]string{"true"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "revision":[]string{"0.0.5"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "pid":[]string{"13899"}, "application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D13899%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470886932407"}}}}
	[2016/08/11 11:42:12 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:155] service name:im.youni.iccs.status.api.StatusUpdateService, get service{[]*registry.ServiceURL(nil)} event, its current member lists:
	[2016/08/11 11:42:12 CST] [INFO] [dubbogo/selector/cache.(*cacheSelector).update:168] selector add serviceURL{registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"anyhost":[]string{"true"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "revision":[]string{"0.0.5"}, "server":[]string{"jetty"}, "side":[]string{"provider"}, "timestamp":[]string{"1470886932407"}, "application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "pid":[]string{"13899"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D13899%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470886932407"}}
	[2016/08/11 11:42:12 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:174] after update, cache.services[im.youni.iccs.status.api.StatusUpdateService] member list size{1}
	[2016/08/11 11:42:12 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:177] cache.services[im.youni.iccs.status.api.StatusUpdateService][0] = service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "pid":[]string{"13899"}, "anyhost":[]string{"true"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "revision":[]string{"0.0.5"}, "server":[]string{"jetty"}, "side":[]string{"provider"}, "timestamp":[]string{"1470886932407"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D13899%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470886932407"}}
	7"}, "anyhost":[]string{"true"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "revision":[]string{"0.0.5"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D13899%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470886932407"}}}}, error{<nil>}
	[2016/08/11 11:42:12 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:151] update @registry result{Result{Action{add service url}, Service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"server":[]string{"jetty"}, "side":[]string{"provider"}, "timestamp":[]string{"1470886932407"}, "anyhost":[]string{"true"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "revision":[]string{"0.0.5"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "pid":[]string{"13899"}, "application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D13899%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470886932407"}}}}
	[2016/08/11 11:42:12 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:155] service name:im.youni.iccs.status.api.StatusUpdateService, get service{[]*registry.ServiceURL(nil)} event, its current member lists:
	[2016/08/11 11:42:12 CST] [INFO] [dubbogo/selector/cache.(*cacheSelector).update:168] selector add serviceURL{registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"anyhost":[]string{"true"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "revision":[]string{"0.0.5"}, "server":[]string{"jetty"}, "side":[]string{"provider"}, "timestamp":[]string{"1470886932407"}, "application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "pid":[]string{"13899"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D13899%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470886932407"}}
	[2016/08/11 11:42:12 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:174] after update, cache.services[im.youni.iccs.status.api.StatusUpdateService] member list size{1}
	[2016/08/11 11:42:12 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:177] cache.services[im.youni.iccs.status.api.StatusUpdateService][0] = service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "pid":[]string{"13899"}, "anyhost":[]string{"true"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "revision":[]string{"0.0.5"}, "server":[]string{"jetty"}, "side":[]string{"provider"}, "timestamp":[]string{"1470886932407"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D13899%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470886932407"}}

可见cmg已经正确地获取到了启动的第一个status provider的相关信息。再启动第二个status后，cmg/logs/debug.log的内容如下：

	[2016/08/11 11:53:18 CST] [WARN] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:218] get a zookeeper event{zk.Event{Type:4, State:3, Path:"/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers", Err:error(nil), Server:""}}, state{3-zookeeper node data changed}
	[2016/08/11 11:53:18 CST] [WARN] [dubbogo/registry/zk.newZookeeperClient.func1:112] get a zookeeper event{zk.Event{Type:4, State:3, Path:"/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers", Err:error(nil), Server:""}}, state{3}:zookeeper node data changed
	[2016/08/11 11:53:18 CST] [INFO] [dubbogo/registry/zk.newZookeeperClient.func1:125] zkClient get zk node changed event{path:/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers}
	[2016/08/11 11:53:18 CST] [INFO] [dubbogo/registry/zk.(*zookeeperWatcher).handleZkNodeEvent:117] add zkNode{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers/dubbo%3A%2F%2F116.211.15.191%3A20880%2Fim.youni.iccs.status.api.StatusUpdateService%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D14224%26revision%3D0.0.5%26side%3Dprovider%26timestamp%3D1470887598421}
	[2016/08/11 11:53:18 CST] [WARN] [dubbogo/registry/zk.(*zookeeperWatcher).handleZkNodeEvent:124] serviceURL{&registry.ServiceURL{Protocol:"dubbo", Location:"116.211.15.191:20880", Path:"/im.youni.iccs.status.api.StatusUpdateService", Ip:"116.211.15.191", Port:"20880", Version:"", Group:"", Query:url.Values{"application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "pid":[]string{"14224"}, "side":[]string{"provider"}, "timestamp":[]string{"1470887598421"}, "anyhost":[]string{"true"}, "revision":[]string{"0.0.5"}, "dubbo":[]string{"2.5.3"}}, Weight:0, PrimitiveURL:"dubbo%3A%2F%2F116.211.15.191%3A20880%2Fim.youni.iccs.status.api.StatusUpdateService%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D14224%26revision%3D0.0.5%26side%3Dprovider%26timestamp%3D1470887598421"}} is not compatible with ServiceConfig{registry.ServiceConfig{Protocol:"jsonrpc", Service:"im.youni.iccs.status.api.StatusUpdateService", Group:"", Version:""}}
	[2016/08/11 11:53:18 CST] [WARN] [dubbogo/registry/zk.newZookeeperClient.func1:112] get a zookeeper event{zk.Event{Type:4, State:3, Path:"/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers", Err:error(nil), Server:""}}, state{3}:zookeeper node data changed
	[2016/08/11 11:53:18 CST] [WARN] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:218] get a zookeeper event{zk.Event{Type:4, State:3, Path:"/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers", Err:error(nil), Server:""}}, state{3-zookeeper node data changed}
	[2016/08/11 11:53:18 CST] [INFO] [dubbogo/registry/zk.newZookeeperClient.func1:125] zkClient get zk node changed event{path:/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers}
	[2016/08/11 11:53:18 CST] [INFO] [dubbogo/registry/zk.(*zookeeperWatcher).handleZkNodeEvent:117] add zkNode{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers/jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D14224%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470887598512}
	[2016/08/11 11:53:18 CST] [INFO] [dubbogo/registry/zk.(*zookeeperWatcher).handleZkNodeEvent:127] add serviceURL{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"timestamp":[]string{"1470887598512"}, "anyhost":[]string{"true"}, "default.threads":[]string{"100"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "revision":[]string{"0.0.5"}, "side":[]string{"provider"}, "application":[]string{"status-dubbo-p"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "pid":[]string{"14224"}, "server":[]string{"jetty"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D14224%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470887598512"}}
	[2016/08/11 11:53:18 CST] [INFO] [dubbogo/registry/zk.(*zookeeperWatcher).handleZkNodeEvent.func1:131] delete zkNode{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers/jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D14224%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470887598512}
	[2016/08/11 11:53:18 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).watch:285] watch.Next() = result{Result{Action{add service url}, Service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"pid":[]string{"14224"}, "server":[]string{"jetty"}, "application":[]string{"status-dubbo-p"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "revision":[]string{"0.0.5"}, "side":[]string{"provider"}, "timestamp":[]string{"1470887598512"}, "anyhost":[]string{"true"}, "default.threads":[]string{"100"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D14224%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470887598512"}}}}, error{<nil>}
	[2016/08/11 11:53:18 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:151] update @registry result{Result{Action{add service url}, Service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"side":[]string{"provider"}, "timestamp":[]string{"1470887598512"}, "anyhost":[]string{"true"}, "default.threads":[]string{"100"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "revision":[]string{"0.0.5"}, "server":[]string{"jetty"}, "application":[]string{"status-dubbo-p"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "pid":[]string{"14224"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D14224%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470887598512"}}}}
	[2016/08/11 11:53:18 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:155] service name:im.youni.iccs.status.api.StatusUpdateService, get service{[]*registry.ServiceURL{(*registry.ServiceURL)(0xc8200787e0)}} event, its current member lists:
	[2016/08/11 11:53:18 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:158] cache.services[im.youni.iccs.status.api.StatusUpdateService][0] = service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.192:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.192", Port:"30880", Version:"", Group:"", Query:url.Values{"server":[]string{"jetty"}, "timestamp":[]string{"1470887564507"}, "default.threads":[]string{"100"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "revision":[]string{"0.0.5"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "pid":[]string{"12766"}, "side":[]string{"provider"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "dubbo":[]string{"2.5.3"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D12766%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470887564507"}}
	[2016/08/11 11:53:18 CST] [INFO] [dubbogo/selector/cache.(*cacheSelector).update:168] selector add serviceURL{registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"application":[]string{"status-dubbo-p"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "pid":[]string{"14224"}, "server":[]string{"jetty"}, "anyhost":[]string{"true"}, "default.threads":[]string{"100"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "revision":[]string{"0.0.5"}, "side":[]string{"provider"}, "timestamp":[]string{"1470887598512"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D14224%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470887598512"}}
	[2016/08/11 11:53:18 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:174] after update, cache.services[im.youni.iccs.status.api.StatusUpdateService] member list size{2}
	[2016/08/11 11:53:18 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:177] cache.services[im.youni.iccs.status.api.StatusUpdateService][0] = service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.192:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.192", Port:"30880", Version:"", Group:"", Query:url.Values{"pid":[]string{"12766"}, "side":[]string{"provider"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "timestamp":[]string{"1470887564507"}, "default.threads":[]string{"100"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "revision":[]string{"0.0.5"}, "server":[]string{"jetty"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D12766%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470887564507"}}
	[2016/08/11 11:53:18 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:177] cache.services[im.youni.iccs.status.api.StatusUpdateService][1] = service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "pid":[]string{"14224"}, "server":[]string{"jetty"}, "application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "revision":[]string{"0.0.5"}, "side":[]string{"provider"}, "timestamp":[]string{"1470887598512"}, "anyhost":[]string{"true"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D14224%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470887598512"}}
	[2016/08/11 11:53:18 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:174] after update, cache.services[im.youni.iccs.status.api.StatusUpdateService] member list size{2}
	[2016/08/11 11:53:18 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:177] cache.services[im.youni.iccs.status.api.StatusUpdateService][0] = service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.192:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.192", Port:"30880", Version:"", Group:"", Query:url.Values{"pid":[]string{"12766"}, "side":[]string{"provider"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "timestamp":[]string{"1470887564507"}, "default.threads":[]string{"100"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "revision":[]string{"0.0.5"}, "server":[]string{"jetty"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D12766%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470887564507"}}
	[2016/08/11 11:53:18 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:177] cache.services[im.youni.iccs.status.api.StatusUpdateService][1] = service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "pid":[]string{"14224"}, "server":[]string{"jetty"}, "application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "revision":[]string{"0.0.5"}, "side":[]string{"provider"}, "timestamp":[]string{"1470887598512"}, "anyhost":[]string{"true"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D14224%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470887598512"}}

可见cmg已经正确地获取到了第二个status provider的相关信息。

### 2.6 有cmg & status，启停zk ####
---

这个测试的目的是观察zk发生重启时候，是否影响dubbogo对外提供服务。

### 2.6.1 关闭zk ####
---

关闭zk，cmg/logs/debug.log日志如下：
	
	[2016/08/11 14:19:58 CST] [WARN] [dubbogo/registry/zk.(*zookeeperClient).handleZkEvent:115] get a zookeeper event{zk.Event{Type:-1, State:1, Path:"", Err:error(nil), Server:"116.211.15.192:2201"}}, state{1}:zookeeper connecting
	[2016/08/11 14:19:58 CST] [WARN] [dubbogo/registry/zk.(*zookeeperClient).handleZkEvent:115] get a zookeeper event{zk.Event{Type:-1, State:1, Path:"", Err:error(nil), Server:"116.211.15.192:2201"}}, state{1}:zookeeper connecting
	[2016/08/11 14:19:58 CST] [EROR] [dubbogo/registry/zk.(*zookeeperClient).getChildrenW:317] zk.ChildrenW(path{/dubbo/im.youni.token.api.AccessKeyService/providers}) = error(zk: could not connect to a server)
	[2016/08/11 14:19:58 CST] [EROR] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:187] watchDir(path{/dubbo/im.youni.token.api.AccessKeyService/providers}) = error{zk: could not connect to a server}
	[2016/08/11 14:19:59 CST] [WARN] [dubbogo/registry/zk.(*zookeeperClient).handleZkEvent:115] get a zookeeper event{zk.Event{Type:-1, State:1, Path:"", Err:error(nil), Server:"116.211.15.192:2201"}}, state{1}:zookeeper connecting
	[2016/08/11 14:19:59 CST] [WARN] [dubbogo/registry/zk.(*zookeeperClient).handleZkEvent:115] get a zookeeper event{zk.Event{Type:-1, State:1, Path:"", Err:error(nil), Server:"116.211.15.192:2201"}}, state{1}:zookeeper connecting
	[2016/08/11 14:20:00 CST] [EROR] [dubbogo/registry/zk.(*zookeeperClient).getChildrenW:317] zk.ChildrenW(path{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers}) = error(zk: could not connect to a server)
	[2016/08/11 14:20:00 CST] [EROR] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:187] watchDir(path{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers}) = error{zk: could not connect to a server}
	[2016/08/11 14:20:00 CST] [WARN] [dubbogo/registry/zk.(*zookeeperClient).handleZkEvent:115] get a zookeeper event{zk.Event{Type:-1, State:1, Path:"", Err:error(nil), Server:"116.211.15.192:2201"}}, state{1}:zookeeper connecting

同时cmg处理cmb请求日志如下：
	
	[2016/08/11 14:23:21 CST] [DEBG] [dubbogo/client.(*rpcClient).call.func1:156] check request{&client.rpcRequest{service:"im.youni.iccs.status.api.StatusUpdateService", method:"login0", contentType:"application/json", request:[]*domain.LoginInfo{(*domain.LoginInfo)(0xc8206f61b0)}, opts:client.RequestOptions{Stream:false, Context:context.Context(nil)}}}, stream condition before store the conn object into pool
	[2016/08/11 14:23:21 CST] [DEBG] [dubbogo/client.(*rpcClient).call.func1:156] check request{&client.rpcRequest{service:"im.youni.iccs.status.api.StatusUpdateService", method:"login0", contentType:"application/json", request:[]*domain.LoginInfo{(*domain.LoginInfo)(0xc820df75f0)}, opts:client.RequestOptions{Stream:false, Context:context.Context(nil)}}}, stream condition before store the conn object into pool
	[2016/08/11 14:23:21 CST] [DEBG] [dubbogo/client.(*rpcClient).Call.func1:299] @i{0}, call(ID{30950393874}, ctx{context.Background.WithValue("dubbogo-ctx", map[string]string{"X-Method":"login0", "X-Proxy-Id":"dubbogo", "X-Services":"im.youni.iccs.status.api.StatusUpdateService"}).WithDeadline(2016-08-11 14:23:22.011175014 +0800 CST [328.967631ms])}, address{116.211.15.192:30880}, path{/im.youni.iccs.status.api.StatusUpdateService2}, request{&{im.youni.iccs.status.api.StatusUpdateService login0 application/json [0xc8206f61b0] {false <nil>}}}, response{<nil>}) = err{<nil>}
	[2016/08/11 14:23:21 CST] [DEBG] [dubbogo/client.(*rpcClient).Call.func1:299] @i{0}, call(ID{30950393870}, ctx{context.Background.WithValue("dubbogo-ctx", map[string]string{"X-Method":"login0", "X-Proxy-Id":"dubbogo", "X-Services":"im.youni.iccs.status.api.StatusUpdateService"}).WithDeadline(2016-08-11 14:23:22.007729978 +0800 CST [325.520795ms])}, address{116.211.15.192:30880}, path{/im.youni.iccs.status.api.StatusUpdateService2}, request{&{im.youni.iccs.status.api.StatusUpdateService login0 application/json [0xc820df75f0] {false <nil>}}}, response{<nil>}) = err{<nil>}
	[2016/08/11 14:23:21 CST] [DEBG] [dubbogo/client.(*rpcStream).Recv:119] rpcStream.Recv(msg{<nil>}) = r.err{<nil> <nil>}
	[2016/08/11 14:23:21 CST] [DEBG] [dubbogo/client.(*rpcClient).call.func1:156] check request{&client.rpcRequest{service:"im.youni.iccs.status.api.StatusUpdateService", method:"login0", contentType:"application/json", request:[]*domain.LoginInfo{(*domain.LoginInfo)(0xc820a5bb90)}, opts:client.RequestOptions{Stream:false, Context:context.Context(nil)}}}, stream condition before store the conn object into pool
	[2016/08/11 14:23:21 CST] [DEBG] [dubbogo/client.(*rpcClient).Call.func1:299] @i{0}, call(ID{30950393872}, ctx{context.Background.WithValue("dubbogo-ctx", map[string]string{"X-Proxy-Id":"dubbogo", "X-Services":"im.youni.iccs.status.api.StatusUpdateService", "X-Method":"login0"}).WithDeadline(2016-08-11 14:23:22.00963635 +0800 CST [326.910967ms])}, address{116.211.15.192:30880}, path{/im.youni.iccs.status.api.StatusUpdateService2}, request{&{im.youni.iccs.status.api.StatusUpdateService login0 application/json [0xc820a5bb90] {false <nil>}}}, response{<nil>}) = err{<nil>}
	[2016/08/11 14:23:21 CST] [DEBG] [dubbogo/client.(*rpcStream).Recv:119] rpcStream.Recv(msg{<nil>}) = r.err{<nil> <nil>}
	[2016/08/11 14:23:21 CST] [DEBG] [dubbogo/client.(*rpcStream).Recv:119] rpcStream.Recv(msg{<nil>}) = r.err{<nil> <nil>}
	[2016/08/11 14:23:21 CST] [DEBG] [dubbogo/client.(*rpcClient).call.func1:156] check request{&client.rpcRequest{service:"im.youni.iccs.status.api.StatusUpdateService", method:"login0", contentType:"application/json", request:[]*domain.LoginInfo{(*domain.LoginInfo)(0xc821150240)}, opts:client.RequestOptions{Stream:false, Context:context.Context(nil)}}}, stream condition before store the conn object into pool
	[2016/08/11 14:23:21 CST] [DEBG] [dubbogo/client.(*rpcClient).call.func1:156] check request{&client.rpcRequest{service:"im.youni.iccs.status.api.StatusUpdateService", method:"login0", contentType:"application/json", request:[]*domain.LoginInfo{(*domain.LoginInfo)(0xc8201e6fc0)}, opts:client.RequestOptions{Stream:false, Context:context.Context(nil)}}}, stream condition before store the conn object into pool
	[2016/08/11 14:23:21 CST] [DEBG] [dubbogo/client.(*rpcClient).Call.func1:299] @i{0}, call(ID{30950393871}, ctx{context.Background.WithValue("dubbogo-ctx", map[string]string{"X-Services":"im.youni.iccs.status.api.StatusUpdateService", "X-Method":"login0", "X-Proxy-Id":"dubbogo"}).WithDeadline(2016-08-11 14:23:22.008090022 +0800 CST [296.041302ms])}, address{116.211.15.191:30880}, path{/im.youni.iccs.status.api.StatusUpdateService2}, request{&{im.youni.iccs.status.api.StatusUpdateService login0 application/json [0xc821150240] {false <nil>}}}, response{<nil>}) = err{<nil>}
	[2016/08/11 14:23:21 CST] [DEBG] [dubbogo/client.(*rpcClient).Call.func1:299] @i{0}, call(ID{30950393873}, ctx{context.Background.WithValue("dubbogo-ctx", map[string]string{"X-Proxy-Id":"dubbogo", "X-Services":"im.youni.iccs.status.api.StatusUpdateService", "X-Method":"login0"}).WithDeadline(2016-08-11 14:23:22.010855771 +0800 CST [298.796986ms])}, address{116.211.15.191:30880}, path{/im.youni.iccs.status.api.StatusUpdateService2}, request{&{im.youni.iccs.status.api.StatusUpdateService login0 application/json [0xc8201e6fc0] {false <nil>}}}, response{<nil>}) = err{<nil>}

可见dubbogo与zk连接断开的情况下，cmg依然能否响应cmb的请求。

#### 2.6.1 启动zk ####
---

重启zk之后，cmg/logs/debug.log日志如下：

	[2016/08/11 15:23:49 CST] [WARN] [dubbogo/registry/zk.(*zookeeperClient).handleZkEvent:115] get a zookeeper event{zk.Event{Type:-1, State:1, Path:"", Err:error(nil), Server:"116.211.15.192:2201"}}, state{1}:zookeeper connecting
	[2016/08/11 15:23:50 CST] [WARN] [dubbogo/registry/zk.(*zookeeperClient).handleZkEvent:115] get a zookeeper event{zk.Event{Type:-1, State:100, Path:"", Err:error(nil), Server:"116.211.15.192:2201"}}, state{100}:zookeeper conneced
	[2016/08/11 15:23:50 CST] [WARN] [dubbogo/registry/zk.(*zookeeperClient).handleZkEvent:115] get a zookeeper event{zk.Event{Type:-1, State:101, Path:"", Err:error(nil), Server:"116.211.15.192:2201"}}, state{101}:zookeeper has session
	[2016/08/11 15:23:51 CST] [EROR] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:187] watchDir(path{/dubbo/im.youni.token.api.AccessKeyService/providers}) = error{path{/dubbo/im.youni.token.api.AccessKeyService/providers} has none children}
	[2016/08/11 15:24:10 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).get:82] c.cache[service{im.youni.iccs.status.api.StatusUpdateService}] = services{[0xc820b3a2d0 0xc820b3af30]}
	[2016/08/11 15:24:10 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).Select:333] get(service{im.youni.iccs.status.api.StatusUpdateService} = serviceURL array{[]*registry.ServiceURL{(*registry.ServiceURL)(0xc820b3a2d0), (*registry.ServiceURL)(0xc820b3af30)}})
	[2016/08/11 15:24:10 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).Select:340] services[0] = serviceURL{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "pid":[]string{"16166"}, "revision":[]string{"0.0.5"}, "server":[]string{"jetty"}, "side":[]string{"provider"}, "timestamp":[]string{"1470893519822"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D16166%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470893519822"}}
	[2016/08/11 15:24:10 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).Select:340] services[1] = serviceURL{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.192:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.192", Port:"30880", Version:"", Group:"", Query:url.Values{"default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "pid":[]string{"16580"}, "revision":[]string{"0.0.5"}, "server":[]string{"jetty"}, "timestamp":[]string{"1470899866061"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "side":[]string{"provider"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D16580%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470899866061"}}
	[2016/08/11 15:24:10 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).Select:340] services[0] = serviceURL{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "pid":[]string{"16166"}, "revision":[]string{"0.0.5"}, "server":[]string{"jetty"}, "side":[]string{"provider"}, "timestamp":[]string{"1470893519822"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D16166%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470893519822"}}
	[2016/08/11 15:24:10 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).Select:340] services[1] = serviceURL{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.192:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.192", Port:"30880", Version:"", Group:"", Query:url.Values{"default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "pid":[]string{"16580"}, "revision":[]string{"0.0.5"}, "server":[]string{"jetty"}, "timestamp":[]string{"1470899866061"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "side":[]string{"provider"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D16580%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470899866061"}}
	[2016/08/11 15:24:10 CST] [DEBG] [dubbogo/client.(*rpcStream).Recv:119] rpcStream.Recv(msg{<nil>}) = r.err{<nil> <nil>}
	[2016/08/11 15:24:10 CST] [DEBG] [dubbogo/client.(*rpcClient).call.func1:156] check request{&client.rpcRequest{service:"im.youni.iccs.status.api.StatusUpdateService", method:"heartbeat", contentType:"application/json", request:[]*domain.LoginInfo{(*domain.LoginInfo)(0xc8201ebdd0)}, opts:client.RequestOptions{Stream:false, Context:context.Context(nil)}}}, stream condition before store the conn object into pool
	[2016/08/11 15:24:10 CST] [DEBG] [dubbogo/client.(*rpcClient).Call.func1:299] @i{0}, call(ID{4033176271}, ctx{context.Background.WithValue("dubbogo-ctx", map[string]string{"X-Proxy-Id":"dubbogo", "X-Services":"im.youni.iccs.status.api.StatusUpdateService", "X-Method":"heartbeat"}).WithDeadline(2016-08-11 15:24:11.029020784 +0800 CST [494.105209ms])}, address{116.211.15.192:30880}, path{/im.youni.iccs.status.api.StatusUpdateService2}, request{&{im.youni.iccs.status.api.StatusUpdateService heartbeat application/json [0xc8201ebdd0] {false <nil>}}}, response{<nil>}) = err{<nil>}
	[2016/08/11 15:24:10 CST] [DEBG] [dubbogo/client.(*rpcClient).call.func1:156] check request{&client.rpcRequest{service:"im.youni.iccs.status.api.StatusUpdateService", method:"heartbeat", contentType:"application/json", request:[]*domain.LoginInfo{(*domain.LoginInfo)(0xc8201ebdd0)}, opts:client.RequestOptions{Stream:false, Context:context.Context(nil)}}}, stream condition before store the conn object into pool
	[2016/08/11 15:24:10 CST] [DEBG] [dubbogo/client.(*rpcClient).Call.func1:299] @i{0}, call(ID{4033176271}, ctx{context.Background.WithValue("dubbogo-ctx", map[string]string{"X-Proxy-Id":"dubbogo", "X-Services":"im.youni.iccs.status.api.StatusUpdateService", "X-Method":"heartbeat"}).WithDeadline(2016-08-11 15:24:11.029020784 +0800 CST [494.105209ms])}, address{116.211.15.192:30880}, path{/im.youni.iccs.status.api.StatusUpdateService2}, request{&{im.youni.iccs.status.api.StatusUpdateService heartbeat application/json [0xc8201ebdd0] {false <nil>}}}, response{<nil>}) = err{<nil>}

从上面log来看，zk重启后，dubbogo能够及时连接zk并且获取到status provider相关信息。

### 2.7  有cmg & zk & status, 关闭status & zk，然后再启动status & zk ####
---

本测试的目的是测试服务端与zk同时崩溃时，dubbogo能否在服务重启后提供稳定的服务。


#### 2.7.1 关闭status #####
---

关闭status后，cmg/logs/debug.log相关内容如下:

	[2016/08/11 17:27:56 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).get:82] c.cache[service{im.youni.iccs.status.api.StatusUpdateService}] = services{[0xc8200783f0 0xc8208bdcb0]}
	[2016/08/11 17:27:56 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).Select:333] get(service{im.youni.iccs.status.api.StatusUpdateService} = serviceURL array{[]*registry.ServiceURL{(*registry.ServiceURL)(0xc8200783f0), (*registry.ServiceURL)(0xc8208bdcb0)}})
	[2016/08/11 17:27:56 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).Select:340] services[0] = serviceURL{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"revision":[]string{"0.0.5"}, "server":[]string{"jetty"}, "side":[]string{"provider"}, "default.threads":[]string{"100"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "pid":[]string{"16166"}, "timestamp":[]string{"1470893519822"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "dubbo":[]string{"2.5.3"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D16166%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470893519822"}}
	[2016/08/11 17:27:56 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).Select:340] services[0] = serviceURL{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"revision":[]string{"0.0.5"}, "server":[]string{"jetty"}, "side":[]string{"provider"}, "default.threads":[]string{"100"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "pid":[]string{"16166"}, "timestamp":[]string{"1470893519822"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "dubbo":[]string{"2.5.3"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D16166%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470893519822"}}
	[2016/08/11 17:27:56 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).Select:340] services[1] = serviceURL{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.192:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.192", Port:"30880", Version:"", Group:"", Query:url.Values{"pid":[]string{"18501"}, "revision":[]string{"0.0.5"}, "side":[]string{"provider"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "server":[]string{"jetty"}, "timestamp":[]string{"1470907669361"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D18501%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470907669361"}}
	[2016/08/11 17:27:56 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).Select:340] services[1] = serviceURL{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.192:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.192", Port:"30880", Version:"", Group:"", Query:url.Values{"pid":[]string{"18501"}, "revision":[]string{"0.0.5"}, "side":[]string{"provider"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "server":[]string{"jetty"}, "timestamp":[]string{"1470907669361"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D18501%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470907669361"}}
	[2016/08/11 17:27:56 CST] [EROR] [dubbogo/client.(*rpcClient).Call:316] reqID{5831564255}, @i{0}, ctx.Done()
	[2016/08/11 17:27:56 CST] [DEBG] [dubbogo/client.(*rpcClient).call.func1:156] check request{&client.rpcRequest{service:"im.youni.iccs.status.api.StatusUpdateService", method:"heartbeat", contentType:"application/json", request:[]*domain.LoginInfo{(*domain.LoginInfo)(0xc820359290)}, opts:client.RequestOptions{Stream:false, Context:context.Context(nil)}}}, stream condition before store the conn object into pool
	[2016/08/11 17:27:56 CST] [DEBG] [dubbogo/client.(*rpcClient).Call.func1:299] @i{0}, call(ID{5831564255}, ctx{context.Background.WithValue("dubbogo-ctx", map[string]string{"X-Proxy-Id":"dubbogo", "X-Services":"im.youni.iccs.status.api.StatusUpdateService", "X-Method":"heartbeat"}).WithDeadline(2016-08-11 17:27:56.617639154 +0800 CST [-313.301Âµs])}, address{116.211.15.192:30880}, path{/im.youni.iccs.status.api.StatusUpdateService2}, request{&{im.youni.iccs.status.api.StatusUpdateService heartbeat application/json [0xc820359290] {false <nil>}}}, response{<nil>}) = err{{"id":"dubbogo.client","code":408,"detail":"context deadline exceeded","status":"Request Timeout"}}
	[2016/08/11 17:27:56 CST] [DEBG] [dubbogo/client.(*rpcStream).Recv:119] rpcStream.Recv(msg{<nil>}) = r.err{<nil> <nil>}
	[2016/08/11 17:28:01 CST] [EROR] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:187] watchDir(path{/dubbo/im.youni.token.api.AccessKeyService/providers}) = error{path{/dubbo/im.youni.token.api.AccessKeyService/providers} has none children}
	[2016/08/11 17:28:06 CST] [WARN] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:218] get a zookeeper event{zk.Event{Type:4, State:3, Path:"/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers", Err:error(nil), Server:""}}, state{3-zookeeper node data changed}
	[2016/08/11 17:28:06 CST] [WARN] [dubbogo/registry/zk.(*zookeeperClient).handleZkEvent:115] get a zookeeper event{zk.Event{Type:2, State:3, Path:"/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers/jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D18501%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470907669361", Err:error(nil), Server:""}}, state{3}:zookeeper node data changed
	[2016/08/11 17:28:06 CST] [INFO] [dubbogo/registry/zk.(*zookeeperClient).handleZkEvent:128] zkClient get zk node changed event{path:/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers/jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D18501%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470907669361}
	[2016/08/11 17:28:06 CST] [WARN] [dubbogo/registry/zk.(*zookeeperWatcher).watchServiceNode:73] get a zookeeper event{zk.Event{Type:2, State:3, Path:"/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers/jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D18501%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470907669361", Err:error(nil), Server:""}}, state{3-zookeeper node data changed}
	[2016/08/11 17:28:06 CST] [WARN] [dubbogo/registry/zk.(*zookeeperWatcher).watchServiceNode:82] zk.ExistW(key{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers/jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D18501%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470907669361}) = event{EventNodeDeleted}
	[2016/08/11 17:28:06 CST] [INFO] [dubbogo/registry/zk.(*zookeeperWatcher).handleZkNodeEvent.func1:135] delete serviceURL{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.192:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.192", Port:"30880", Version:"", Group:"", Query:url.Values{"dubbo":[]string{"2.5.3"}, "pid":[]string{"18501"}, "revision":[]string{"0.0.5"}, "side":[]string{"provider"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "timestamp":[]string{"1470907669361"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "server":[]string{"jetty"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D18501%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470907669361"}}
	[2016/08/11 17:28:06 CST] [WARN] [dubbogo/registry/zk.(*zookeeperWatcher).handleZkNodeEvent.func1:138] watchSelf(zk path{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers}) goroutine exit now
	[2016/08/11 17:28:06 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).watch:285] watch.Next() = result{Result{Action{delete service url}, Service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.192:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.192", Port:"30880", Version:"", Group:"", Query:url.Values{"interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "server":[]string{"jetty"}, "timestamp":[]string{"1470907669361"}, "pid":[]string{"18501"}, "revision":[]string{"0.0.5"}, "side":[]string{"provider"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D18501%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470907669361"}}}}, error{<nil>}
	[2016/08/11 17:28:06 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).watch:285] watch.Next() = result{Result{Action{delete service url}, Service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.192:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.192", Port:"30880", Version:"", Group:"", Query:url.Values{"interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "server":[]string{"jetty"}, "timestamp":[]string{"1470907669361"}, "pid":[]string{"18501"}, "revision":[]string{"0.0.5"}, "side":[]string{"provider"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D18501%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470907669361"}}}}, error{<nil>}
	[2016/08/11 17:28:06 CST] [WARN] [dubbogo/registry/zk.(*zookeeperWatcher).handleZkNodeEvent:152] delete zkPath{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers/jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D18501%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470907669361}
	[2016/08/11 17:28:06 CST] [WARN] [dubbogo/registry/zk.(*zookeeperWatcher).handleZkNodeEvent:158] delete serviceURL{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.192:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.192", Port:"30880", Version:"", Group:"", Query:url.Values{"application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "side":[]string{"provider"}, "anyhost":[]string{"true"}, "pid":[]string{"18501"}, "revision":[]string{"0.0.5"}, "server":[]string{"jetty"}, "timestamp":[]string{"1470907669361"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D18501%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470907669361"}}
	[2016/08/11 17:28:06 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:151] update @registry result{Result{Action{delete service url}, Service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.192:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.192", Port:"30880", Version:"", Group:"", Query:url.Values{"dubbo":[]string{"2.5.3"}, "pid":[]string{"18501"}, "revision":[]string{"0.0.5"}, "side":[]string{"provider"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "timestamp":[]string{"1470907669361"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "server":[]string{"jetty"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D18501%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470907669361"}}}}
	[2016/08/11 17:28:06 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:155] service name:im.youni.iccs.status.api.StatusUpdateService, get service{[]*registry.ServiceURL{(*registry.ServiceURL)(0xc8200783f0), (*registry.ServiceURL)(0xc8208bdcb0)}} event, its current member lists:
	[2016/08/11 17:28:06 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:158] cache.services[im.youni.iccs.status.api.StatusUpdateService][0] = service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "revision":[]string{"0.0.5"}, "server":[]string{"jetty"}, "side":[]string{"provider"}, "default.threads":[]string{"100"}, "application":[]string{"status-dubbo-p"}, "dubbo":[]string{"2.5.3"}, "pid":[]string{"16166"}, "timestamp":[]string{"1470893519822"}, "anyhost":[]string{"true"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D16166%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470893519822"}}
	[2016/08/11 17:28:06 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:158] cache.services[im.youni.iccs.status.api.StatusUpdateService][1] = service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.192:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.192", Port:"30880", Version:"", Group:"", Query:url.Values{"default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "pid":[]string{"18501"}, "revision":[]string{"0.0.5"}, "side":[]string{"provider"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "server":[]string{"jetty"}, "timestamp":[]string{"1470907669361"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D18501%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470907669361"}}
	[2016/08/11 17:28:06 CST] [EROR] [dubbogo/selector/cache.(*cacheSelector).update:170] selector delete serviceURL{registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.192:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.192", Port:"30880", Version:"", Group:"", Query:url.Values{"dubbo":[]string{"2.5.3"}, "pid":[]string{"18501"}, "revision":[]string{"0.0.5"}, "side":[]string{"provider"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "timestamp":[]string{"1470907669361"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "server":[]string{"jetty"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D18501%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470907669361"}}
	[2016/08/11 17:28:06 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:174] after update, cache.services[im.youni.iccs.status.api.StatusUpdateService] member list size{1}
	[2016/08/11 17:28:06 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:177] cache.services[im.youni.iccs.status.api.StatusUpdateService][0] = service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"default.threads":[]string{"100"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "revision":[]string{"0.0.5"}, "server":[]string{"jetty"}, "side":[]string{"provider"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "dubbo":[]string{"2.5.3"}, "pid":[]string{"16166"}, "timestamp":[]string{"1470893519822"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D16166%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470893519822"}}
	[2016/08/11 17:28:06 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).watch:285] watch.Next() = result{Result{Action{delete service url}, Service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.192:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.192", Port:"30880", Version:"", Group:"", Query:url.Values{"dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "side":[]string{"provider"}, "application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "revision":[]string{"0.0.5"}, "server":[]string{"jetty"}, "timestamp":[]string{"1470907669361"}, "anyhost":[]string{"true"}, "pid":[]string{"18501"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D18501%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470907669361"}}}}, error{<nil>}
	[2016/08/11 17:28:06 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:151] update @registry result{Result{Action{delete service url}, Service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.192:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.192", Port:"30880", Version:"", Group:"", Query:url.Values{"application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "side":[]string{"provider"}, "anyhost":[]string{"true"}, "pid":[]string{"18501"}, "revision":[]string{"0.0.5"}, "server":[]string{"jetty"}, "timestamp":[]string{"1470907669361"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D18501%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470907669361"}}}}
	[2016/08/11 17:28:06 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:155] service name:im.youni.iccs.status.api.StatusUpdateService, get service{[]*registry.ServiceURL{(*registry.ServiceURL)(0xc8200783f0)}} event, its current member lists:
	[2016/08/11 17:28:06 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:158] cache.services[im.youni.iccs.status.api.StatusUpdateService][0] = service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"default.threads":[]string{"100"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "revision":[]string{"0.0.5"}, "server":[]string{"jetty"}, "side":[]string{"provider"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "dubbo":[]string{"2.5.3"}, "pid":[]string{"16166"}, "timestamp":[]string{"1470893519822"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D16166%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470893519822"}}
	[2016/08/11 17:28:06 CST] [EROR] [dubbogo/selector/cache.(*cacheSelector).update:170] selector delete serviceURL{registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.192:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.192", Port:"30880", Version:"", Group:"", Query:url.Values{"anyhost":[]string{"true"}, "pid":[]string{"18501"}, "revision":[]string{"0.0.5"}, "server":[]string{"jetty"}, "timestamp":[]string{"1470907669361"}, "application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "side":[]string{"provider"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D18501%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470907669361"}}
         
从上面log可以看出，服务全面暂停。

#### 2.7.2 关闭zk ####
---

关闭zk后，cmg/logs/debug.log相关内容如下:


	[2016/08/11 17:35:46 CST] [WARN] [dubbogo/registry/zk.(*zookeeperClient).handleZkEvent:115] get a zookeeper event{zk.Event{Type:-1, State:0, Path:"", Err:error(nil), Server:"116.211.15.192:2201"}}, state{0}:zookeeper disconnected
	[2016/08/11 17:35:46 CST] [WARN] [dubbogo/registry/zk.(*zookeeperClient).handleZkEvent:118] zk{addr:[116.211.15.192:2201]} state is StateDisconnected, so close the zk client{name:zk registry}.
	[2016/08/11 17:35:46 CST] [INFO] [dubbogo/registry/zk.(*zookeeperClient).handleZkEvent.func1:106] zk{path:[116.211.15.192:2201], name:zk registry} connection goroutine game over.
	[2016/08/11 17:35:46 CST] [WARN] [dubbogo/registry/zk.(*zookeeperClient).handleZkEvent:115] get a zookeeper event{zk.Event{Type:-1, State:0, Path:"", Err:error(nil), Server:"116.211.15.192:2201"}}, state{0}:zookeeper disconnected
	[2016/08/11 17:35:46 CST] [WARN] [dubbogo/registry/zk.(*zookeeperClient).handleZkEvent:118] zk{addr:[116.211.15.192:2201]} state is StateDisconnected, so close the zk client{name:watcher zk registry}.
	[2016/08/11 17:35:46 CST] [INFO] [dubbogo/registry/zk.(*zookeeperClient).handleZkEvent.func1:106] zk{path:[116.211.15.192:2201], name:watcher zk registry} connection goroutine game over.
	[2016/08/11 17:35:46 CST] [WARN] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:205] client.done(), watch(path{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers}, ServiceConfig{registry.ServiceConfig{Protocol:"jsonrpc", Service:"im.youni.iccs.status.api.StatusUpdateService", Group:"", Version:""}}) goroutine exit now...
	[2016/08/11 17:35:46 CST] [WARN] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:205] client.done(), watch(path{/dubbo/im.youni.token.api.AccessKeyService/providers}, ServiceConfig{registry.ServiceConfig{Protocol:"jsonrpc", Service:"im.youni.token.api.AccessKeyService", Group:"", Version:""}}) goroutine exit now...
	[2016/08/11 17:35:46 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).watch:285] watch.Next() = result{<nil>}, error{&errors.errorString{s:"watcher stopped"}}
	[2016/08/11 17:35:46 CST] [WARN] [dubbogo/registry/zk.(*zookeeperWatcher).watchService.func2:284] watchDir(zkPath{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers}) goroutine exit now
	[2016/08/11 17:35:46 CST] [WARN] [dubbogo/registry/zk.(*zookeeperWatcher).watchService.func2:284] watchDir(zkPath{/dubbo/im.youni.token.api.AccessKeyService/providers}) goroutine exit now
	[2016/08/11 17:35:46 CST] [WARN] [dubbogo/registry/zk.(*zookeeperClient).Close:203] zk client{name:watcher zk registry, zk addr:[116.211.15.192:2201]} exit now.
	[2016/08/11 17:35:46 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).run:218] cache.watch(w) = err{&errors.errorString{s:"watcher stopped"}}
	[2016/08/11 17:35:46 CST] [WARN] [dubbogo/selector/cache.(*cacheSelector).run:221] cacheSelector.watch() = error{watcher stopped}
	[2016/08/11 17:35:47 CST] [INFO] [dubbogo/registry/zk.(*consumerZookeeperRegistry).Watch:286] watch dubbo provider path{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers} and wait to get all provider zk nodes
	[2016/08/11 17:35:47 CST] [INFO] [dubbogo/registry/zk.(*consumerZookeeperRegistry).Watch:286] watch dubbo provider path{/dubbo/im.youni.token.api.AccessKeyService/providers} and wait to get all provider zk nodes
	[2016/08/11 17:35:47 CST] [WARN] [dubbogo/registry/zk.(*zookeeperClient).handleZkEvent:115] get a zookeeper event{zk.Event{Type:-1, State:1, Path:"", Err:error(nil), Server:"116.211.15.192:2201"}}, state{1}:zookeeper connecting
	[2016/08/11 17:35:47 CST] [WARN] [dubbogo/registry/zk.(*zookeeperClient).handleZkEvent:115] get a zookeeper event{zk.Event{Type:-1, State:1, Path:"", Err:error(nil), Server:"116.211.15.192:2201"}}, state{1}:zookeeper connecting
	[2016/08/11 17:35:47 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).run:206] cache.Registry.Watch() = watch{&zookeeper.zookeeperWatcher{once:sync.Once{m:sync.Mutex{state:0, sema:0x0}, done:0x0}, client:(*zookeeper.zookeeperClient)(0xc820199080), events:(chan zookeeper.event)(0xc8201c1140), wait:sync.WaitGroup{state1:[12]uint8{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0}, sema:0x0}}}, error{<nil>}

#### 2.7.3 重启zk ####
---

启动zk后，cmg/logs/debug.log相关内容如下:

	[2016/08/11 17:38:12 CST] [WARN] [dubbogo/registry/zk.(*zookeeperClient).handleZkEvent:115] get a zookeeper event{zk.Event{Type:-1, State:1, Path:"", Err:error(nil), Server:"116.211.15.192:2201"}}, state{1}:zookeeper connecting
	[2016/08/11 17:38:13 CST] [WARN] [dubbogo/registry/zk.(*zookeeperClient).handleZkEvent:115] get a zookeeper event{zk.Event{Type:-1, State:1, Path:"", Err:error(nil), Server:"116.211.15.192:2201"}}, state{1}:zookeeper connecting
	[2016/08/11 17:38:14 CST] [WARN] [dubbogo/registry/zk.(*zookeeperClient).handleZkEvent:115] get a zookeeper event{zk.Event{Type:-1, State:1, Path:"", Err:error(nil), Server:"116.211.15.192:2201"}}, state{1}:zookeeper connecting
	[2016/08/11 17:38:15 CST] [WARN] [dubbogo/registry/zk.(*zookeeperClient).handleZkEvent:115] get a zookeeper event{zk.Event{Type:-1, State:100, Path:"", Err:error(nil), Server:"116.211.15.192:2201"}}, state{100}:zookeeper conneced
	[2016/08/11 17:38:16 CST] [WARN] [dubbogo/registry/zk.(*zookeeperClient).handleZkEvent:115] get a zookeeper event{zk.Event{Type:-1, State:101, Path:"", Err:error(nil), Server:"116.211.15.192:2201"}}, state{101}:zookeeper has session

从上面的日志来看，dubbogo/registry/zk/client.go:consumerZookeeperRegistry与zk连接恢复正常。

#### 2.7.4 重启status ####
---

启动status后，cmg/logs/debug.log相关内容如下:

	
	[2016/08/11 17:38:34 CST] [EROR] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:187] watchDir(path{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers}) = error{path{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers} has none children}
	[2016/08/11 17:38:36 CST] [EROR] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:187] watchDir(path{/dubbo/im.youni.token.api.AccessKeyService/providers}) = error{path{/dubbo/im.youni.token.api.AccessKeyService/providers} has none children}
	[2016/08/11 17:38:37 CST] [WARN] [dubbogo/registry/zk.(*zookeeperClient).handleZkEvent:115] get a zookeeper event{zk.Event{Type:4, State:3, Path:"/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers", Err:error(nil), Server:""}}, state{3}:zookeeper node data changed
	[2016/08/11 17:38:37 CST] [INFO] [dubbogo/registry/zk.(*zookeeperClient).handleZkEvent:128] zkClient get zk node changed event{path:/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers}
	[2016/08/11 17:38:37 CST] [INFO] [dubbogo/registry/zk.(*zookeeperClient).handleZkEvent:132] send event{state:zk.EventNodeDataChange, Path:/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers} notify event to path{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers} related watcher
	[2016/08/11 17:38:37 CST] [INFO] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:208] get zk.EventNodeDataChange notify event
	[2016/08/11 17:38:37 CST] [INFO] [dubbogo/registry/zk.(*zookeeperWatcher).handleZkNodeEvent:117] add zkNode{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers/dubbo%3A%2F%2F116.211.15.192%3A20880%2Fim.youni.iccs.status.api.StatusUpdateService%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D18864%26revision%3D0.0.5%26side%3Dprovider%26timestamp%3D1470908317481}
	[2016/08/11 17:38:37 CST] [WARN] [dubbogo/registry/zk.(*zookeeperWatcher).handleZkNodeEvent:124] serviceURL{&registry.ServiceURL{Protocol:"dubbo", Location:"116.211.15.192:20880", Path:"/im.youni.iccs.status.api.StatusUpdateService", Ip:"116.211.15.192", Port:"20880", Version:"", Group:"", Query:url.Values{"interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "pid":[]string{"18864"}, "revision":[]string{"0.0.5"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "side":[]string{"provider"}, "timestamp":[]string{"1470908317481"}}, Weight:0, PrimitiveURL:"dubbo%3A%2F%2F116.211.15.192%3A20880%2Fim.youni.iccs.status.api.StatusUpdateService%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D18864%26revision%3D0.0.5%26side%3Dprovider%26timestamp%3D1470908317481"}} is not compatible with ServiceConfig{registry.ServiceConfig{Protocol:"jsonrpc", Service:"im.youni.iccs.status.api.StatusUpdateService", Group:"", Version:""}}
	[2016/08/11 17:38:37 CST] [WARN] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:218] get a zookeeper event{zk.Event{Type:4, State:3, Path:"/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers", Err:error(nil), Server:""}}, state{3-zookeeper node data changed}
	[2016/08/11 17:38:37 CST] [WARN] [dubbogo/registry/zk.(*zookeeperClient).handleZkEvent:115] get a zookeeper event{zk.Event{Type:4, State:3, Path:"/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers", Err:error(nil), Server:""}}, state{3}:zookeeper node data changed
	[2016/08/11 17:38:37 CST] [INFO] [dubbogo/registry/zk.(*zookeeperClient).handleZkEvent:128] zkClient get zk node changed event{path:/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers}
	[2016/08/11 17:38:37 CST] [INFO] [dubbogo/registry/zk.(*zookeeperWatcher).handleZkNodeEvent:117] add zkNode{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers/jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D18864%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470908317562}
	[2016/08/11 17:38:37 CST] [INFO] [dubbogo/registry/zk.(*zookeeperWatcher).handleZkNodeEvent:127] add serviceURL{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.192:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.192", Port:"30880", Version:"", Group:"", Query:url.Values{"anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "server":[]string{"jetty"}, "timestamp":[]string{"1470908317562"}, "default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "pid":[]string{"18864"}, "revision":[]string{"0.0.5"}, "side":[]string{"provider"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D18864%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470908317562"}}
	[2016/08/11 17:38:37 CST] [INFO] [dubbogo/registry/zk.(*zookeeperWatcher).handleZkNodeEvent.func1:131] delete zkNode{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers/jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D18864%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470908317562}
	[2016/08/11 17:38:37 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).watch:285] watch.Next() = result{Result{Action{add service url}, Service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.192:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.192", Port:"30880", Version:"", Group:"", Query:url.Values{"default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "pid":[]string{"18864"}, "revision":[]string{"0.0.5"}, "side":[]string{"provider"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "server":[]string{"jetty"}, "timestamp":[]string{"1470908317562"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D18864%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470908317562"}}}}, error{<nil>}
	[2016/08/11 17:38:37 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:151] update @registry result{Result{Action{add service url}, Service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.192:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.192", Port:"30880", Version:"", Group:"", Query:url.Values{"anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "server":[]string{"jetty"}, "timestamp":[]string{"1470908317562"}, "side":[]string{"provider"}, "default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "pid":[]string{"18864"}, "revision":[]string{"0.0.5"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D18864%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470908317562"}}}}
	[2016/08/11 17:38:37 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:155] service name:im.youni.iccs.status.api.StatusUpdateService, get service{[]*registry.ServiceURL(nil)} event, its current member lists:
	[2016/08/11 17:38:37 CST] [INFO] [dubbogo/selector/cache.(*cacheSelector).update:168] selector add serviceURL{registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.192:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.192", Port:"30880", Version:"", Group:"", Query:url.Values{"default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "pid":[]string{"18864"}, "revision":[]string{"0.0.5"}, "side":[]string{"provider"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "server":[]string{"jetty"}, "timestamp":[]string{"1470908317562"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D18864%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470908317562"}}
	[2016/08/11 17:38:37 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:174] after update, cache.services[im.youni.iccs.status.api.StatusUpdateService] member list size{1}
	[2016/08/11 17:38:37 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:177] cache.services[im.youni.iccs.status.api.StatusUpdateService][0] = service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.192:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.192", Port:"30880", Version:"", Group:"", Query:url.Values{"methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "server":[]string{"jetty"}, "timestamp":[]string{"1470908317562"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "pid":[]string{"18864"}, "revision":[]string{"0.0.5"}, "side":[]string{"provider"}, "default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D18864%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470908317562"}}

启动第二个status后，cmg/logs/debug.log相关内容如下:
	
	[2016/08/11 17:39:05 CST] [WARN] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:218] get a zookeeper event{zk.Event{Type:4, State:3, Path:"/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers", Err:error(nil), Server:""}}, state{3-zookeeper node data changed}
	[2016/08/11 17:39:05 CST] [WARN] [dubbogo/registry/zk.(*zookeeperClient).handleZkEvent:115] get a zookeeper event{zk.Event{Type:4, State:3, Path:"/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers", Err:error(nil), Server:""}}, state{3}:zookeeper node data changed
	[2016/08/11 17:39:05 CST] [INFO] [dubbogo/registry/zk.(*zookeeperClient).handleZkEvent:128] zkClient get zk node changed event{path:/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers}
	[2016/08/11 17:39:05 CST] [INFO] [dubbogo/registry/zk.(*zookeeperClient).handleZkEvent:128] zkClient get zk node changed event{path:/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers}
	[2016/08/11 17:39:05 CST] [INFO] [dubbogo/registry/zk.(*zookeeperWatcher).handleZkNodeEvent:117] add zkNode{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers/dubbo%3A%2F%2F116.211.15.191%3A20880%2Fim.youni.iccs.status.api.StatusUpdateService%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D19818%26revision%3D0.0.5%26side%3Dprovider%26timestamp%3D1470908345687}
	[2016/08/11 17:39:05 CST] [WARN] [dubbogo/registry/zk.(*zookeeperWatcher).handleZkNodeEvent:124] serviceURL{&registry.ServiceURL{Protocol:"dubbo", Location:"116.211.15.191:20880", Path:"/im.youni.iccs.status.api.StatusUpdateService", Ip:"116.211.15.191", Port:"20880", Version:"", Group:"", Query:url.Values{"timestamp":[]string{"1470908345687"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "pid":[]string{"19818"}, "revision":[]string{"0.0.5"}, "side":[]string{"provider"}}, Weight:0, PrimitiveURL:"dubbo%3A%2F%2F116.211.15.191%3A20880%2Fim.youni.iccs.status.api.StatusUpdateService%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D19818%26revision%3D0.0.5%26side%3Dprovider%26timestamp%3D1470908345687"}} is not compatible with ServiceConfig{registry.ServiceConfig{Protocol:"jsonrpc", Service:"im.youni.iccs.status.api.StatusUpdateService", Group:"", Version:""}}
	[2016/08/11 17:39:05 CST] [WARN] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:218] get a zookeeper event{zk.Event{Type:4, State:3, Path:"/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers", Err:error(nil), Server:""}}, state{3-zookeeper node data changed}
	[2016/08/11 17:39:05 CST] [WARN] [dubbogo/registry/zk.(*zookeeperClient).handleZkEvent:115] get a zookeeper event{zk.Event{Type:4, State:3, Path:"/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers", Err:error(nil), Server:""}}, state{3}:zookeeper node data changed
	[2016/08/11 17:39:05 CST] [INFO] [dubbogo/registry/zk.(*zookeeperClient).handleZkEvent:128] zkClient get zk node changed event{path:/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers}
	[2016/08/11 17:39:05 CST] [INFO] [dubbogo/registry/zk.(*zookeeperWatcher).handleZkNodeEvent:117] add zkNode{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers/jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D19818%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470908345800}
	[2016/08/11 17:39:05 CST] [INFO] [dubbogo/registry/zk.(*zookeeperWatcher).handleZkNodeEvent:127] add serviceURL{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "server":[]string{"jetty"}, "side":[]string{"provider"}, "timestamp":[]string{"1470908345800"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "pid":[]string{"19818"}, "revision":[]string{"0.0.5"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D19818%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470908345800"}}
	[2016/08/11 17:39:05 CST] [INFO] [dubbogo/registry/zk.(*zookeeperWatcher).handleZkNodeEvent.func1:131] delete zkNode{/dubbo/im.youni.iccs.status.api.StatusUpdateService/providers/jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D19818%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470908345800}
	[2016/08/11 17:39:05 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).watch:285] watch.Next() = result{Result{Action{add service url}, Service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "server":[]string{"jetty"}, "revision":[]string{"0.0.5"}, "side":[]string{"provider"}, "timestamp":[]string{"1470908345800"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "pid":[]string{"19818"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D19818%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470908345800"}}}}, error{<nil>}
	[2016/08/11 17:39:05 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:151] update @registry result{Result{Action{add service url}, Service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"side":[]string{"provider"}, "timestamp":[]string{"1470908345800"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "pid":[]string{"19818"}, "revision":[]string{"0.0.5"}, "default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "server":[]string{"jetty"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D19818%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470908345800"}}}}
	[2016/08/11 17:39:05 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:155] service name:im.youni.iccs.status.api.StatusUpdateService, get service{[]*registry.ServiceURL{(*registry.ServiceURL)(0xc8208bd290)}} event, its current member lists:
	[2016/08/11 17:39:05 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:155] service name:im.youni.iccs.status.api.StatusUpdateService, get service{[]*registry.ServiceURL{(*registry.ServiceURL)(0xc8208bd290)}} event, its current member lists:
	[2016/08/11 17:39:05 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:158] cache.services[im.youni.iccs.status.api.StatusUpdateService][0] = service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.192:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.192", Port:"30880", Version:"", Group:"", Query:url.Values{"server":[]string{"jetty"}, "timestamp":[]string{"1470908317562"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "pid":[]string{"18864"}, "revision":[]string{"0.0.5"}, "side":[]string{"provider"}, "default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D18864%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470908317562"}}
	[2016/08/11 17:39:05 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:158] cache.services[im.youni.iccs.status.api.StatusUpdateService][0] = service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.192:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.192", Port:"30880", Version:"", Group:"", Query:url.Values{"server":[]string{"jetty"}, "timestamp":[]string{"1470908317562"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "pid":[]string{"18864"}, "revision":[]string{"0.0.5"}, "side":[]string{"provider"}, "default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D18864%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470908317562"}}
	[2016/08/11 17:39:05 CST] [INFO] [dubbogo/selector/cache.(*cacheSelector).update:168] selector add serviceURL{registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "server":[]string{"jetty"}, "timestamp":[]string{"1470908345800"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "pid":[]string{"19818"}, "revision":[]string{"0.0.5"}, "side":[]string{"provider"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D19818%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470908345800"}}
	[2016/08/11 17:39:05 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:174] after update, cache.services[im.youni.iccs.status.api.StatusUpdateService] member list size{2}
	[2016/08/11 17:39:05 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:177] cache.services[im.youni.iccs.status.api.StatusUpdateService][0] = service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.192:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.192", Port:"30880", Version:"", Group:"", Query:url.Values{"default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "pid":[]string{"18864"}, "revision":[]string{"0.0.5"}, "side":[]string{"provider"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "server":[]string{"jetty"}, "timestamp":[]string{"1470908317562"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D18864%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470908317562"}}
	[2016/08/11 17:39:05 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:177] cache.services[im.youni.iccs.status.api.StatusUpdateService][1] = service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "server":[]string{"jetty"}, "revision":[]string{"0.0.5"}, "side":[]string{"provider"}, "timestamp":[]string{"1470908345800"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "pid":[]string{"19818"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D19818%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470908345800"}}
	[2016/08/11 17:39:05 CST] [INFO] [dubbogo/selector/cache.(*cacheSelector).update:168] selector add serviceURL{registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "server":[]string{"jetty"}, "timestamp":[]string{"1470908345800"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "pid":[]string{"19818"}, "revision":[]string{"0.0.5"}, "side":[]string{"provider"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D19818%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470908345800"}}
	[2016/08/11 17:39:05 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:174] after update, cache.services[im.youni.iccs.status.api.StatusUpdateService] member list size{2}
	[2016/08/11 17:39:05 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:177] cache.services[im.youni.iccs.status.api.StatusUpdateService][0] = service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.192:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.192", Port:"30880", Version:"", Group:"", Query:url.Values{"default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "pid":[]string{"18864"}, "revision":[]string{"0.0.5"}, "side":[]string{"provider"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "server":[]string{"jetty"}, "timestamp":[]string{"1470908317562"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.192%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D18864%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470908317562"}}
	[2016/08/11 17:39:05 CST] [DEBG] [dubbogo/selector/cache.(*cacheSelector).update:177] cache.services[im.youni.iccs.status.api.StatusUpdateService][1] = service{&registry.ServiceURL{Protocol:"jsonrpc", Location:"116.211.15.191:30880", Path:"/im.youni.iccs.status.api.StatusUpdateService2", Ip:"116.211.15.191", Port:"30880", Version:"", Group:"", Query:url.Values{"default.threads":[]string{"100"}, "dubbo":[]string{"2.5.3"}, "interface":[]string{"im.youni.iccs.status.api.StatusUpdateService"}, "server":[]string{"jetty"}, "revision":[]string{"0.0.5"}, "side":[]string{"provider"}, "timestamp":[]string{"1470908345800"}, "anyhost":[]string{"true"}, "application":[]string{"status-dubbo-p"}, "methods":[]string{"logout,updateLocale,heartbeat,clearStatus,login0,login"}, "pid":[]string{"19818"}}, Weight:0, PrimitiveURL:"jsonrpc%3A%2F%2F116.211.15.191%3A30880%2Fim.youni.iccs.status.api.StatusUpdateService2%3Fanyhost%3Dtrue%26application%3Dstatus-dubbo-p%26default.threads%3D100%26dubbo%3D2.5.3%26interface%3Dim.youni.iccs.status.api.StatusUpdateService%26methods%3Dlogout%2CupdateLocale%2Cheartbeat%2CclearStatus%2Clogin0%2Clogin%26pid%3D19818%26revision%3D0.0.5%26server%3Djetty%26side%3Dprovider%26timestamp%3D1470908345800"}}
	[2016/08/11 17:39:06 CST] [EROR] [dubbogo/registry/zk.(*zookeeperWatcher).watchDir:187] watchDir(path{/dubbo/im.youni.token.api.AccessKeyService/providers}) = error{path{/dubbo/im.youni.token.api.AccessKeyService/providers} has none children}

从上面日志的内容，可以看出dubbogo的相关行为与预先设计的一致:
1 第一个status的发现，要依靠dubbogo/registry/zk:(zookeeperClient) handleZkEvent()通知dubbogo/registry/zk:(zookeeperWatcher) watchDir()；
2 第二个status启动后，dubbogo/registry/zk:(zookeeperWatcher) watchDir()自身能否及时发现值。
  
## 3 性能测试 ##
---

### 3.1 jsonrpc 2.0 二进制抓包内容 ###
---

下面附录一个dubbogo的请求响应流程的抓包结果：

    21:01:16.347997 IP (tos 0x0, ttl 64, id 36983, offset 0, flags [DF], proto TCP (6), length 52)
        10.136.16.62.56397 > 10.136.16.61.10000: Flags [S], cksum 0x027c (correct), seq 2736347017, win 14600, options [mss 1460,nop,nop,sackOK,nop,wscale 9], length 0
            0x0000:  4500 0034 9077 4000 4006 74c2 0a88 103e  E..4.w@.@.t....>
            0x0010:  0a88 103d dc4d 2710 a319 5789 0000 0000  ...=.M'...W.....
            0x0020:  8002 3908 027c 0000 0204 05b4 0101 0402  ..9..|..........
            0x0030:  0103 0309                                ....
    21:01:16.348022 IP (tos 0x0, ttl 64, id 0, offset 0, flags [DF], proto TCP (6), length 52)
        10.136.16.61.10000 > 10.136.16.62.56397: Flags [S.], cksum 0x9034 (correct), seq 4189681788, ack 2736347018, win 14600, options [mss 1460,nop,nop,sackOK,nop,wscale 9], length 0
            0x0000:  4500 0034 0000 4000 4006 053a 0a88 103d  E..4..@.@..:...=
            0x0010:  0a88 103e 2710 dc4d f9b9 787c a319 578a  ...>'..M..x|..W.
            0x0020:  8012 3908 9034 0000 0204 05b4 0101 0402  ..9..4..........
            0x0030:  0103 0309                                ....
    21:01:16.348083 IP (tos 0x0, ttl 64, id 36984, offset 0, flags [DF], proto TCP (6), length 40)
        10.136.16.62.56397 > 10.136.16.61.10000: Flags [.], cksum 0x09f4 (correct), seq 1, ack 1, win 29, length 0
            0x0000:  4500 0028 9078 4000 4006 74cd 0a88 103e  E..(.x@.@.t....>
            0x0010:  0a88 103d dc4d 2710 a319 578a f9b9 787d  ...=.M'...W...x}
            0x0020:  5010 001d 09f4 0000 0000 0000 0000       P.............
    21:01:16.348568 IP (tos 0x0, ttl 64, id 36985, offset 0, flags [DF], proto TCP (6), length 378)
        10.136.16.62.56397 > 10.136.16.61.10000: Flags [P.], cksum 0x12c7 (correct), seq 1:339, ack 1, win 29, length 338
            0x0000:  4500 017a 9079 4000 4006 737a 0a88 103e  E..z.y@.@.sz...>
            0x0010:  0a88 103d dc4d 2710 a319 578a f9b9 787d  ...=.M'...W...x}
            0x0020:  5018 001d 12c7 0000 504f 5354 202f 636f  P.......POST./co
            0x0030:  6d2e 796f 756e 692e 4865 6c6c 6f53 6572  m.youni.HelloSer
            0x0040:  7669 6365 2048 5454 502f 312e 310d 0a48  vice.HTTP/1.1..H
            0x0050:  6f73 743a 2031 302e 3133 362e 3136 2e36  ost:.10.136.16.6
            0x0060:  313a 3130 3030 300d 0a55 7365 722d 4167  1:10000..User-Ag
            0x0070:  656e 743a 2047 6f2d 6874 7470 2d63 6c69  ent:.Go-http-cli
            0x0080:  656e 742f 312e 310d 0a43 6f6e 7465 6e74  ent/1.1..Content
            0x0090:  2d4c 656e 6774 683a 2036 380d 0a41 6363  -Length:.68..Acc
            0x00a0:  6570 743a 2061 7070 6c69 6361 7469 6f6e  ept:.application
            0x00b0:  2f6a 736f 6e0d 0a43 6f6e 7465 6e74 2d54  /json..Content-T
            0x00c0:  7970 653a 2061 7070 6c69 6361 7469 6f6e  ype:.application
            0x00d0:  2f6a 736f 6e0d 0a54 696d 656f 7574 3a20  /json..Timeout:.
            0x00e0:  3335 3030 3030 3030 300d 0a58 2d4d 6574  350000000..X-Met
            0x00f0:  686f 643a 2045 6368 6f0d 0a58 2d50 726f  hod:.Echo..X-Pro
            0x0100:  7879 2d49 643a 2064 7562 626f 676f 0d0a  xy-Id:.dubbogo..
            0x0110:  582d 5365 7276 6963 6573 3a20 636f 6d2e  X-Services:.com.
            0x0120:  796f 756e 692e 4865 6c6c 6f53 6572 7669  youni.HelloServi
            0x0130:  6365 0d0a 0d0a 7b22 6a73 6f6e 7270 6322  ce....{"jsonrpc"
            0x0140:  3a22 322e 3022 2c22 6d65 7468 6f64 223a  :"2.0","method":
            0x0150:  2245 6368 6f22 2c22 7061 7261 6d73 223a  "Echo","params":
            0x0160:  5b22 4865 6c6c 6f2c 2057 6f72 6c64 2122  ["Hello,.World!"
            0x0170:  5d2c 2269 6422 3a30 7d0a                 ],"id":0}.
    21:01:16.348598 IP (tos 0x0, ttl 64, id 27661, offset 0, flags [DF], proto TCP (6), length 40)
        10.136.16.61.10000 > 10.136.16.62.56397: Flags [.], cksum 0x08a0 (correct), seq 1, ack 339, win 31, length 0
            0x0000:  4500 0028 6c0d 4000 4006 9938 0a88 103d  E..(l.@.@..8...=
            0x0010:  0a88 103e 2710 dc4d f9b9 787d a319 58dc  ...>'..M..x}..X.
            0x0020:  5010 001f 08a0 0000                      P.......
    21:01:16.349097 IP (tos 0x0, ttl 64, id 27662, offset 0, flags [DF], proto TCP (6), length 57)
        10.136.16.61.10000 > 10.136.16.62.56397: Flags [P.], cksum 0x35b6 (incorrect -> 0x48c1), seq 1:18, ack 339, win 31, length 17
            0x0000:  4500 0039 6c0e 4000 4006 9926 0a88 103d  E..9l.@.@..&...=
            0x0010:  0a88 103e 2710 dc4d f9b9 787d a319 58dc  ...>'..M..x}..X.
            0x0020:  5018 001f 35b6 0000 4854 5450 2f31 2e31  P...5...HTTP/1.1
            0x0030:  2032 3030 204f 4b0d 0a                   .200.OK..
    21:01:16.349121 IP (tos 0x0, ttl 64, id 27663, offset 0, flags [DF], proto TCP (6), length 56)
        10.136.16.61.10000 > 10.136.16.62.56397: Flags [P.], cksum 0x35b5 (incorrect -> 0x13a2), seq 18:34, ack 339, win 31, length 16
            0x0000:  4500 0038 6c0f 4000 4006 9926 0a88 103d  E..8l.@.@..&...=
            0x0010:  0a88 103e 2710 dc4d f9b9 788e a319 58dc  ...>'..M..x...X.
            0x0020:  5018 001f 35b5 0000 436f 6e74 656e 742d  P...5...Content-
            0x0030:  4c65 6e67 7468 3a20                      Length:.
    21:01:16.349133 IP (tos 0x0, ttl 64, id 27664, offset 0, flags [DF], proto TCP (6), length 44)
        10.136.16.61.10000 > 10.136.16.62.56397: Flags [P.], cksum 0x35a9 (incorrect -> 0xc638), seq 34:38, ack 339, win 31, length 4
            0x0000:  4500 002c 6c10 4000 4006 9931 0a88 103d  E..,l.@.@..1...=
            0x0010:  0a88 103e 2710 dc4d f9b9 789e a319 58dc  ...>'..M..x...X.
            0x0020:  5018 001f 35a9 0000 3530 0d0a            P...5...50..
    21:01:16.349164 IP (tos 0x0, ttl 64, id 27665, offset 0, flags [DF], proto TCP (6), length 46)
        10.136.16.61.10000 > 10.136.16.62.56397: Flags [P.], cksum 0x35ab (incorrect -> 0xf32f), seq 38:44, ack 339, win 31, length 6
            0x0000:  4500 002e 6c11 4000 4006 992e 0a88 103d  E...l.@.@......=
            0x0010:  0a88 103e 2710 dc4d f9b9 78a2 a319 58dc  ...>'..M..x...X.
            0x0020:  5018 001f 35ab 0000 4163 6365 7074       P...5...Accept
    21:01:16.349174 IP (tos 0x0, ttl 64, id 27666, offset 0, flags [DF], proto TCP (6), length 42)
        10.136.16.61.10000 > 10.136.16.62.56397: Flags [P.], cksum 0x35a7 (incorrect -> 0xce4a), seq 44:46, ack 339, win 31, length 2
            0x0000:  4500 002a 6c12 4000 4006 9931 0a88 103d  E..*l.@.@..1...=
            0x0010:  0a88 103e 2710 dc4d f9b9 78a8 a319 58dc  ...>'..M..x...X.
            0x0020:  5018 001f 35a7 0000 3a20                 P...5...:.
    21:01:16.349183 IP (tos 0x0, ttl 64, id 27667, offset 0, flags [DF], proto TCP (6), length 56)
        10.136.16.61.10000 > 10.136.16.62.56397: Flags [P.], cksum 0x35b5 (incorrect -> 0xba25), seq 46:62, ack 339, win 31, length 16
            0x0000:  4500 0038 6c13 4000 4006 9922 0a88 103d  E..8l.@.@.."...=
            0x0010:  0a88 103e 2710 dc4d f9b9 78aa a319 58dc  ...>'..M..x...X.
            0x0020:  5018 001f 35b5 0000 6170 706c 6963 6174  P...5...applicat
            0x0030:  696f 6e2f 6a73 6f6e                      ion/json
    21:01:16.349192 IP (tos 0x0, ttl 64, id 27668, offset 0, flags [DF], proto TCP (6), length 42)
        10.136.16.61.10000 > 10.136.16.62.56397: Flags [P.], cksum 0x35a7 (incorrect -> 0xfb4e), seq 62:64, ack 339, win 31, length 2
            0x0000:  4500 002a 6c14 4000 4006 992f 0a88 103d  E..*l.@.@../...=
            0x0010:  0a88 103e 2710 dc4d f9b9 78ba a319 58dc  ...>'..M..x...X.
            0x0020:  5018 001f 35a7 0000 0d0a                 P...5.....
    21:01:16.349202 IP (tos 0x0, ttl 64, id 27669, offset 0, flags [DF], proto TCP (6), length 52)
        10.136.16.61.10000 > 10.136.16.62.56397: Flags [P.], cksum 0x35b1 (incorrect -> 0xb7ee), seq 64:76, ack 339, win 31, length 12
            0x0000:  4500 0034 6c15 4000 4006 9924 0a88 103d  E..4l.@.@..$...=
            0x0010:  0a88 103e 2710 dc4d f9b9 78bc a319 58dc  ...>'..M..x...X.
            0x0020:  5018 001f 35b1 0000 436f 6e74 656e 742d  P...5...Content-
            0x0030:  5479 7065                                Type
    21:01:16.349211 IP (tos 0x0, ttl 64, id 27670, offset 0, flags [DF], proto TCP (6), length 42)
        10.136.16.61.10000 > 10.136.16.62.56397: Flags [P.], cksum 0x35a7 (incorrect -> 0xce2a), seq 76:78, ack 339, win 31, length 2
            0x0000:  4500 002a 6c16 4000 4006 992d 0a88 103d  E..*l.@.@..-...=
            0x0010:  0a88 103e 2710 dc4d f9b9 78c8 a319 58dc  ...>'..M..x...X.
            0x0020:  5018 001f 35a7 0000 3a20                 P...5...:.
    21:01:16.349220 IP (tos 0x0, ttl 64, id 27671, offset 0, flags [DF], proto TCP (6), length 56)
        10.136.16.61.10000 > 10.136.16.62.56397: Flags [P.], cksum 0x35b5 (incorrect -> 0xba05), seq 78:94, ack 339, win 31, length 16
            0x0000:  4500 0038 6c17 4000 4006 991e 0a88 103d  E..8l.@.@......=
            0x0010:  0a88 103e 2710 dc4d f9b9 78ca a319 58dc  ...>'..M..x...X.
            0x0020:  5018 001f 35b5 0000 6170 706c 6963 6174  P...5...applicat
            0x0030:  696f 6e2f 6a73 6f6e                      ion/json
    21:01:16.349263 IP (tos 0x0, ttl 64, id 36986, offset 0, flags [DF], proto TCP (6), length 40)
        10.136.16.62.56397 > 10.136.16.61.10000: Flags [.], cksum 0x0891 (correct), seq 339, ack 18, win 29, length 0
            0x0000:  4500 0028 907a 4000 4006 74cb 0a88 103e  E..(.z@.@.t....>
            0x0010:  0a88 103d dc4d 2710 a319 58dc f9b9 788e  ...=.M'...X...x.
            0x0020:  5010 001d 0891 0000 0000 0000 0000       P.............
    21:01:16.349275 IP (tos 0x0, ttl 64, id 36987, offset 0, flags [DF], proto TCP (6), length 40)
        10.136.16.62.56397 > 10.136.16.61.10000: Flags [.], cksum 0x0881 (correct), seq 339, ack 34, win 29, length 0
            0x0000:  4500 0028 907b 4000 4006 74ca 0a88 103e  E..(.{@.@.t....>
            0x0010:  0a88 103d dc4d 2710 a319 58dc f9b9 789e  ...=.M'...X...x.
            0x0020:  5010 001d 0881 0000 0000 0000 0000       P.............
    21:01:16.349281 IP (tos 0x0, ttl 64, id 36988, offset 0, flags [DF], proto TCP (6), length 40)
        10.136.16.62.56397 > 10.136.16.61.10000: Flags [.], cksum 0x087d (correct), seq 339, ack 38, win 29, length 0
            0x0000:  4500 0028 907c 4000 4006 74c9 0a88 103e  E..(.|@.@.t....>
            0x0010:  0a88 103d dc4d 2710 a319 58dc f9b9 78a2  ...=.M'...X...x.
            0x0020:  5010 001d 087d 0000 0000 0000 0000       P....}........
    21:01:16.349284 IP (tos 0x0, ttl 64, id 27672, offset 0, flags [DF], proto TCP (6), length 169)
        10.136.16.61.10000 > 10.136.16.62.56397: Flags [P.], cksum 0x3626 (incorrect -> 0x03a6), seq 94:223, ack 339, win 31, length 129
            0x0000:  4500 00a9 6c18 4000 4006 98ac 0a88 103d  E...l.@.@......=
            0x0010:  0a88 103e 2710 dc4d f9b9 78da a319 58dc  ...>'..M..x...X.
            0x0020:  5018 001f 3626 0000 0d0a 5469 6d65 6f75  P...6&....Timeou
            0x0030:  743a 2033 3530 3030 3030 3030 0d0a 5573  t:.350000000..Us
            0x0040:  6572 2d41 6765 6e74 3a20 476f 2d68 7474  er-Agent:.Go-htt
            0x0050:  702d 636c 6965 6e74 2f31 2e31 0d0a 582d  p-client/1.1..X-
            0x0060:  4d65 7468 6f64 3a20 4563 686f 0d0a 582d  Method:.Echo..X-
            0x0070:  5072 6f78 792d 4964 3a20 6475 6262 6f67  Proxy-Id:.dubbog
            0x0080:  6f0d 0a58 2d53 6572 7669 6365 733a 2063  o..X-Services:.c
            0x0090:  6f6d 2e79 6f75 6e69 2e48 656c 6c6f 5365  om.youni.HelloSe
            0x00a0:  7276 6963 650d 0a0d 0a                   rvice....
    21:01:16.349287 IP (tos 0x0, ttl 64, id 36989, offset 0, flags [DF], proto TCP (6), length 40)
        10.136.16.62.56397 > 10.136.16.61.10000: Flags [.], cksum 0x0877 (correct), seq 339, ack 44, win 29, length 0
            0x0000:  4500 0028 907d 4000 4006 74c8 0a88 103e  E..(.}@.@.t....>
            0x0010:  0a88 103d dc4d 2710 a319 58dc f9b9 78a8  ...=.M'...X...x.
            0x0020:  5010 001d 0877 0000 0000 0000 0000       P....w........
    21:01:16.349293 IP (tos 0x0, ttl 64, id 36990, offset 0, flags [DF], proto TCP (6), length 40)
        10.136.16.62.56397 > 10.136.16.61.10000: Flags [.], cksum 0x0875 (correct), seq 339, ack 46, win 29, length 0
            0x0000:  4500 0028 907e 4000 4006 74c7 0a88 103e  E..(.~@.@.t....>
            0x0010:  0a88 103d dc4d 2710 a319 58dc f9b9 78aa  ...=.M'...X...x.
            0x0020:  5010 001d 0875 0000 0000 0000 0000       P....u........
    21:01:16.349305 IP (tos 0x0, ttl 64, id 36991, offset 0, flags [DF], proto TCP (6), length 40)
        10.136.16.62.56397 > 10.136.16.61.10000: Flags [.], cksum 0x0865 (correct), seq 339, ack 62, win 29, length 0
            0x0000:  4500 0028 907f 4000 4006 74c6 0a88 103e  E..(..@.@.t....>
            0x0010:  0a88 103d dc4d 2710 a319 58dc f9b9 78ba  ...=.M'...X...x.
            0x0020:  5010 001d 0865 0000 0000 0000 0000       P....e........
    21:01:16.349315 IP (tos 0x0, ttl 64, id 36992, offset 0, flags [DF], proto TCP (6), length 40)
        10.136.16.62.56397 > 10.136.16.61.10000: Flags [.], cksum 0x0863 (correct), seq 339, ack 64, win 29, length 0
            0x0000:  4500 0028 9080 4000 4006 74c5 0a88 103e  E..(..@.@.t....>
            0x0010:  0a88 103d dc4d 2710 a319 58dc f9b9 78bc  ...=.M'...X...x.
            0x0020:  5010 001d 0863 0000 0000 0000 0000       P....c........
    21:01:16.349320 IP (tos 0x0, ttl 64, id 36993, offset 0, flags [DF], proto TCP (6), length 40)
        10.136.16.62.56397 > 10.136.16.61.10000: Flags [.], cksum 0x0857 (correct), seq 339, ack 76, win 29, length 0
            0x0000:  4500 0028 9081 4000 4006 74c4 0a88 103e  E..(..@.@.t....>
            0x0010:  0a88 103d dc4d 2710 a319 58dc f9b9 78c8  ...=.M'...X...x.
            0x0020:  5010 001d 0857 0000 0000 0000 0000       P....W........
    21:01:16.349326 IP (tos 0x0, ttl 64, id 36994, offset 0, flags [DF], proto TCP (6), length 40)
        10.136.16.62.56397 > 10.136.16.61.10000: Flags [.], cksum 0x0855 (correct), seq 339, ack 78, win 29, length 0
            0x0000:  4500 0028 9082 4000 4006 74c3 0a88 103e  E..(..@.@.t....>
            0x0010:  0a88 103d dc4d 2710 a319 58dc f9b9 78ca  ...=.M'...X...x.
            0x0020:  5010 001d 0855 0000 0000 0000 0000       P....U........
    21:01:16.349331 IP (tos 0x0, ttl 64, id 36995, offset 0, flags [DF], proto TCP (6), length 40)
        10.136.16.62.56397 > 10.136.16.61.10000: Flags [.], cksum 0x0845 (correct), seq 339, ack 94, win 29, length 0
            0x0000:  4500 0028 9083 4000 4006 74c2 0a88 103e  E..(..@.@.t....>
            0x0010:  0a88 103d dc4d 2710 a319 58dc f9b9 78da  ...=.M'...X...x.
            0x0020:  5010 001d 0845 0000 0000 0000 0000       P....E........
    21:01:16.349346 IP (tos 0x0, ttl 64, id 27673, offset 0, flags [DF], proto TCP (6), length 90)
        10.136.16.61.10000 > 10.136.16.62.56397: Flags [P.], cksum 0x35d7 (incorrect -> 0xeea1), seq 223:273, ack 339, win 31, length 50
            0x0000:  4500 005a 6c19 4000 4006 98fa 0a88 103d  E..Zl.@.@......=
            0x0010:  0a88 103e 2710 dc4d f9b9 795b a319 58dc  ...>'..M..y[..X.
            0x0020:  5018 001f 35d7 0000 7b22 6a73 6f6e 7270  P...5...{"jsonrp
            0x0030:  6322 3a22 322e 3022 2c22 6964 223a 302c  c":"2.0","id":0,
            0x0040:  2272 6573 756c 7422 3a22 4865 6c6c 6f2c  "result":"Hello,
            0x0050:  2057 6f72 6c64 2122 7d0a                 .World!"}.
    21:01:16.349365 IP (tos 0x0, ttl 64, id 36996, offset 0, flags [DF], proto TCP (6), length 40)
        10.136.16.62.56397 > 10.136.16.61.10000: Flags [.], cksum 0x07c2 (correct), seq 339, ack 223, win 31, length 0
            0x0000:  4500 0028 9084 4000 4006 74c1 0a88 103e  E..(..@.@.t....>
            0x0010:  0a88 103d dc4d 2710 a319 58dc f9b9 795b  ...=.M'...X...y[
            0x0020:  5010 001f 07c2 0000 0000 0000 0000       P.............
    21:01:16.349403 IP (tos 0x0, ttl 64, id 36997, offset 0, flags [DF], proto TCP (6), length 40)
        10.136.16.62.56397 > 10.136.16.61.10000: Flags [.], cksum 0x0790 (correct), seq 339, ack 273, win 31, length 0
            0x0000:  4500 0028 9085 4000 4006 74c0 0a88 103e  E..(..@.@.t....>
            0x0010:  0a88 103d dc4d 2710 a319 58dc f9b9 798d  ...=.M'...X...y.
            0x0020:  5010 001f 0790 0000 0000 0000 0000       P.............

上面的抓包内容反映了目前dubbogo使用JsonRPC 2.0协议的网络流，细心的人会发现一些问题，最新版的dubbogo对其进行了改进。详见：http://alexstocks.github.io/html/go-http-optimize.html 。

### 3.2 性能测试结果 ###
---

从3.1可以看出，http request有338-32=306B，http response有239-32=206B，所以一次请求的HTTP协议的有效字节size为512B。
jsonrpc request有68B，响应有50B。
      
我已经依据dubbogo写了测试用例集dubbogo-examples，本次性能测试使用dubbogo-examples/echo进行简单的http echo性能测试。

测试五次，每次发送100次echo，测试结果如下：

    after loop 100 times, time costs:111.9756ms
    after loop 100 times, time costs:115.5373ms
    after loop 100 times, time costs:113.3338ms
    after loop 100 times, time costs:117.1589ms
    after loop 100 times, time costs:114.8853ms

可计算出每次请求响应平均时间为 572.8909ms / 500 = 1.145782ms。

测试五次，每次发送100000次echo，测试结果如下：

    after loop 100000 times, time costs:1m38.622750432s 98622.750432ms
    after loop 100000 times, time costs:1m38.626437212s 98626.437212ms
    after loop 100000 times, time costs:1m38.195420564s 98195.420564ms
    after loop 100000 times, time costs:1m38.583057363s 98583.057363ms
    after loop 100000 times, time costs:1m38.61988461s  98619.88461ms

可计算出每次请求响应平均时间为 492647.550181ms / 500000 = 0.985ms

可见每次请求响应大概花费1ms，即dubbogo server每秒能够处理大约1000次echo请求。
